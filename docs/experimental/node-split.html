<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-experimental/node-split" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Node split PoC | Spacemesh Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacemesh.io/docs/experimental/node-split"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="X71PuqeyvYyDQE1_3384Aml425A-ZELYBf7-ZfFRUoY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Node split PoC | Spacemesh Documentation"><meta data-rh="true" name="description" content="In our ongoing effort to lower the bar for smeshing, we&#x27;re exploring a new direction for reducing system requirements for smeshers. The idea is to re-architect the internal modules in go-spacemesh, isolating the smeshing logic from the passive consensus code. By dividing the node along these lines, we can enable users to run the lightweight yet sensitive (requiring access to private key) smeshing logic separately from the rest of the node. This allows users with limited resources to use a remote node for their smeshing."><meta data-rh="true" property="og:description" content="In our ongoing effort to lower the bar for smeshing, we&#x27;re exploring a new direction for reducing system requirements for smeshers. The idea is to re-architect the internal modules in go-spacemesh, isolating the smeshing logic from the passive consensus code. By dividing the node along these lines, we can enable users to run the lightweight yet sensitive (requiring access to private key) smeshing logic separately from the rest of the node. This allows users with limited resources to use a remote node for their smeshing."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.spacemesh.io/docs/experimental/node-split"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/experimental/node-split" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/experimental/node-split" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OGGMN1SAN3-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2CL6HG3B96"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2CL6HG3B96",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Spacemesh Documentation" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.css"><link rel="stylesheet" href="/assets/css/styles.a7d2cb45.css">
<link rel="preload" href="/assets/js/runtime~main.e9047b1f.js" as="script">
<link rel="preload" href="/assets/js/main.e1739529.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/learn/spacemesh">Explainers</a><a class="navbar__item navbar__link" href="/docs/start/smeshing/start">Guides</a><a href="https://mainnet-api-docs.spacemesh.network/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Node split PoC</h1><p>In our ongoing effort to lower the bar for smeshing, we&#x27;re exploring a new direction for reducing system requirements for smeshers. The idea is to re-architect the internal modules in go-spacemesh, isolating the smeshing logic from the passive consensus code. By dividing the node along these lines, we can enable users to run the lightweight yet sensitive (requiring access to private key) smeshing logic separately from the rest of the node. This allows users with limited resources to use a remote node for their smeshing.</p><p>We are demonstrating a PoC of the node split, where the smeshing logic is separated from the rest of the node. The PoC is based on the current go-spacemesh codebase and is intended to demonstrate the feasibility of the node split concept. The PoC is not intended to be a production-ready implementation.</p><p>The PoC itself is still work in progress so please expect changes and improvement in the future.</p><p>The architecture of the PoC is as follows:</p><p><img loading="lazy" alt="design.png" src="/assets/images/design-30f55a0f951a0138706f7c3ff614da8b.png" width="2279" height="1535" class="img_ev3q"></p><p>The PoC consists of two separate processes:</p><ul><li><code>node service</code> aka node</li><li><code>smesher service</code> aka client</li></ul><p>The easiest way to understand the setup is to try the PoC yourself. The following instructions will guide you through the process.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-is-this-important">Why is this important?<a href="#why-is-this-important" class="hash-link" aria-label="Direct link to Why is this important?" title="Direct link to Why is this important?">​</a></h2><p>It&#x27;s best to watch the <a href="https://www.youtube.com/watch?v=d4jBz1krRHg" target="_blank" rel="noopener noreferrer">video</a> to get a better understanding of the problem and our reasoning behind the node split.</p><p>The current go-spacemesh node is a monolithic application that includes all the logic required for consensus, smeshing, and other services. This makes it difficult to run the node on low-resource devices, as the node requires a significant amount of resources to run. By splitting the node into two separate services, we can enable users to run the smeshing logic on a separate device, while still connecting to a remote node for the rest of the services. This allows users to run the node on low-resource devices, while still participating in the Spacemesh network.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benefits">Benefits<a href="#benefits" class="hash-link" aria-label="Direct link to Benefits" title="Direct link to Benefits">​</a></h3><ol><li><strong>Lower system requirements</strong>: Users can run the smesher service on low-resource devices, while connecting to a more powerfull node for the rest of the services.</li><li><strong>Better failover and redundancy</strong>: Currently when you need to restart a node you also need to restart the smesher service. With the node split you can restart the node without affecting the smeshing process. Starting smeshing will be also much quicker because it will <em>not</em> need to wait for the node to sync as the node will be running elsewhere. Multiple smesher services can be connected to the same node, and nodes can be hot swapped without affecting the smeshing process.</li><li><strong>Lower OpEx</strong>: Smesher service can be shut down wherever not needed to save costs and resources. Additionally, only a single node is required for multiple smeshing services and it can run where it&#x27;s most cost effective, which is not necessarily where the semshing service runs.</li><li><strong>Better node maintanability</strong>: The node can be updated without affecting the smeshing process and the smeshing service can be updated without re-syncing. This makes updates simpler and less risky.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-poc">Running the PoC<a href="#running-the-poc" class="hash-link" aria-label="Direct link to Running the PoC" title="Direct link to Running the PoC">​</a></h2><p>There are two distinct configuration/setup methods possible:</p><ol><li>Using locally running node and smesher service</li><li>Using remote running node and local smesher service</li></ol><p>We will use a Docker Compose based setup for both options. While it&#x27;s possible to run the PoC without Docker, it&#x27;s more complicated, so for simplicity we&#x27;ll use Docker.</p><p>Both setups will run two smesher services connecting to the same node. Please note that one smesher service can have multiple post services connected to it, as is currently the case with node and post services. However, in this PoC we&#x27;re using only one post service per smesher service.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-locally-running-node-and-smesher-service">Using locally running node and smesher service<a href="#using-locally-running-node-and-smesher-service" class="hash-link" aria-label="Direct link to Using locally running node and smesher service" title="Direct link to Using locally running node and smesher service">​</a></h3><p>Please use the <code>docker-compose-testnet-both-local.yml</code> file for this setup.</p><p>The commands will be:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose -f docker-compose-testnet-both-local.yml [...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since this will be a locally running node, it will need to sync with the network like all Spacemesh nodes. The testnet network is small, so the node should sync relatively quickly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-remote-running-node-and-local-smesher-service">Using remote running node and local smesher service<a href="#using-remote-running-node-and-local-smesher-service" class="hash-link" aria-label="Direct link to Using remote running node and local smesher service" title="Direct link to Using remote running node and local smesher service">​</a></h3><p>Please use the <code>docker-compose-testnet-remote-node.yml</code> file for this setup.</p><p>The commands will be:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker compose -f docker-compose-testnet-remote-node.yml [...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="starting-the-setup">Starting the setup<a href="#starting-the-setup" class="hash-link" aria-label="Direct link to Starting the setup" title="Direct link to Starting the setup">​</a></h3><ol><li>Clone the repository and switch to the <code>node-split-poc</code> branch</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git clone https://github.com/spacemeshos/go-spacemesh.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd go-spacemesh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git checkout node-split-poc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Change directory to the demo directory</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd activation_service_poc/demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>You should see the following files in the directory</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose-testnet-both-local.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose-testnet-remote-node.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Run the docker-compose command according to your chosen setup. For example, to run the setup with locally running node and smesher service, run:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-compose -f docker-compose-testnet-remote-node.yml up -d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After all the steps are done please give each smesher service a while to initialize POST and generate inital post proof. This may take up to a few minutes.</p><p>If all steps are followed correctly, you should see three new Docker containers running. You can check the status of the containers using:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ docker compose -f docker-compose-testnet-remote-node.yml ps</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                                 IMAGE                                    COMMAND                  SERVICE                       CREATED          STATUS          PORTS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demo-activation-service-remote-1-1   spacemeshos/go-spacemesh-dev:2c898bb30   &quot;/bin/go-spacemesh -…&quot;   activation-service-remote-1   39 minutes ago   Up 39 minutes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demo-activation-service-remote-2-1   spacemeshos/go-spacemesh-dev:2c898bb30   &quot;/bin/go-spacemesh -…&quot;   activation-service-remote-2   39 minutes ago   Up 39 minutes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You&#x27;ll also be able to connect to the node&#x27;s UI by visiting <code>https://smesher-alpha.spacemesh.network/</code> in your browser. This is a PoC of the smesher service UI and is not intended to be a production-ready implementation. It uses the smesher service API directly to interact with the smesher service. It&#x27;s fully open source and the code can be found <a href="https://github.com/spacemeshos/smesher-app" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The first time you open the UI it will be mostly empty as you&#x27;re running a fresh smeshing service and therefore don&#x27;t yet have eligibility. Testnet epochs are 24 hours long, so you&#x27;ll need to wait for the next epoch to start smeshing. You can check the epoch number and exact timing in the UI.</p><p>Initially it will look like:
<img loading="lazy" alt="initial-app-state.png" src="/assets/images/initial-app-state-5d8bface90b3a69c57480f40e89be955.png" width="2492" height="1214" class="img_ev3q"></p><p>After a few epochs you should see a UI that looks similar to:
<img loading="lazy" alt="smesher-app.png" src="/assets/images/smesher-app-092c8264bfc002c5f75b1f1059006d99.png" width="2532" height="2640" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="interacting-with-the-poc">Interacting with the PoC<a href="#interacting-with-the-poc" class="hash-link" aria-label="Direct link to Interacting with the PoC" title="Direct link to Interacting with the PoC">​</a></h2><p>The smesher service proxies v2 API calls to the node service. You can query the smesher service API to interact with the attached node. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -X POST http://localhost:19171/spacemesh.v2alpha1.NodeService/Status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will return the node&#x27;s status.</p><p>In addition to the existing v2 API, there is <code>spacemesh.v2alpha1.SmeshingIdentitiesService/States</code> which returns the list of smeshing identities and their detailed states.</p><blockquote><p>[!NOTE]<!-- -->
Please note that currently the state persistence is implemented with some simplifications. States persist across restarts but you will see some duplicates in the list of states. This is a known issue that will be fixed in the final implementation.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stopping-the-setup">Stopping the setup<a href="#stopping-the-setup" class="hash-link" aria-label="Direct link to Stopping the setup" title="Direct link to Stopping the setup">​</a></h2><p>To stop all the containers you can use the following command:</p><p><code>docker compose -f docker-compose-testnet-both-local.yml down</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-content">Extra content<a href="#extra-content" class="hash-link" aria-label="Direct link to Extra content" title="Direct link to Extra content">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-these-magic-ports-used-in-the-docker-compose-files">What are these magic ports used in the docker-compose files?<a href="#what-are-these-magic-ports-used-in-the-docker-compose-files" class="hash-link" aria-label="Direct link to What are these magic ports used in the docker-compose files?" title="Direct link to What are these magic ports used in the docker-compose files?">​</a></h3><p>All ports except the one ending with <code>99</code> are standard ports used in normal/current go-spacemesh setups. The port ending with <code>99</code> is used by the node to expose its API for the smesher service. This port number may change in the future, as it was selected specifically for this PoC.
These different APIs will likely be combined under the same endpoint later, but for simplicity and flexibility they are separated in this PoC.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-about-the---json-cors-everywhere-flag">What about the <code>--json-cors-everywhere</code> flag?<a href="#what-about-the---json-cors-everywhere-flag" class="hash-link" aria-label="Direct link to what-about-the---json-cors-everywhere-flag" title="Direct link to what-about-the---json-cors-everywhere-flag">​</a></h3><p>This is a new flag introduced for the PoC. It configures the node to add CORS headers to all responses, which allows the browser-based UI to query the smesher service API.
While this is not a final solution and will be replaced with a more secure one in the future, please note that this API does not expose any sensitive data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-poc-without-docker">Running the PoC without Docker<a href="#running-the-poc-without-docker" class="hash-link" aria-label="Direct link to Running the PoC without Docker" title="Direct link to Running the PoC without Docker">​</a></h3><p>Use the attached configs, replicate the command line and run the binary files:</p><ol><li>Download the most recent release of node-split-poc go-spacemesh from the <a href="https://github.com/spacemeshos/go-spacemesh/releases" target="_blank" rel="noopener noreferrer">releases page</a> and look for <code>node-split-poc</code> releases.</li><li>Extract the archive and copy the config files (*.json)</li><li>Run the binary or binaries using the same commands specified in the docker-compose file.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-the-config-is-that-big">Why the config is that big?<a href="#why-the-config-is-that-big" class="hash-link" aria-label="Direct link to Why the config is that big?" title="Direct link to Why the config is that big?">​</a></h3><p>The actual differences to the default config are pretty minimal.</p><p>The most important are addition of <code>&quot;node-service-address&quot;: &quot;http://0.0.0.0:9099&quot;</code> in the <code>main</code> section, and the definition of <code>&quot;grpc-local-services&quot;: [&quot;smeshing_identities_v2alpha1&quot;]</code> in the <code>api</code> section.</p></div><div class="feedback-widget margin-top--md margin-bottom--md"><div class="margin-bottom--sm"><b>Was this helpful?</b></div><span class="feedback-widget-positive"><feedback-button project="nzs6xodw4b" rating="1" custom-font="True" button-style="default" modal-position="center"><button class="button button--outline button--primary button--sm" title="Yes"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg></button></feedback-button></span><span class="feedback-widget-negative margin-left--sm"><feedback-button project="nzs6xodw4b" rating="0" custom-font="True" button-style="default" modal-position="center"><button class="button button--outline button--primary button--sm" title="No"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path></svg></button></feedback-button></span></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/spacemeshos/docs/edit/main/docs/experimental/node-split.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-is-this-important" class="table-of-contents__link toc-highlight">Why is this important?</a><ul><li><a href="#benefits" class="table-of-contents__link toc-highlight">Benefits</a></li></ul></li><li><a href="#running-the-poc" class="table-of-contents__link toc-highlight">Running the PoC</a><ul><li><a href="#using-locally-running-node-and-smesher-service" class="table-of-contents__link toc-highlight">Using locally running node and smesher service</a></li><li><a href="#using-remote-running-node-and-local-smesher-service" class="table-of-contents__link toc-highlight">Using remote running node and local smesher service</a></li><li><a href="#starting-the-setup" class="table-of-contents__link toc-highlight">Starting the setup</a></li></ul></li><li><a href="#interacting-with-the-poc" class="table-of-contents__link toc-highlight">Interacting with the PoC</a></li><li><a href="#stopping-the-setup" class="table-of-contents__link toc-highlight">Stopping the setup</a></li><li><a href="#extra-content" class="table-of-contents__link toc-highlight">Extra content</a><ul><li><a href="#what-are-these-magic-ports-used-in-the-docker-compose-files" class="table-of-contents__link toc-highlight">What are these magic ports used in the docker-compose files?</a></li><li><a href="#what-about-the---json-cors-everywhere-flag" class="table-of-contents__link toc-highlight">What about the <code>--json-cors-everywhere</code> flag?</a></li><li><a href="#running-the-poc-without-docker" class="table-of-contents__link toc-highlight">Running the PoC without Docker</a></li><li><a href="#why-the-config-is-that-big" class="table-of-contents__link toc-highlight">Why the config is that big?</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/teamspacemesh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/spacemeshos/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://spacemesh.io/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dash.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dashboard</a></li><li class="footer__item"><a href="https://explorer.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Spacemesh.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e9047b1f.js"></script>
<script src="/assets/js/main.e1739529.js"></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.esm.js"></script>
<script>const feedbackButton=document.createElement("feedback-button");feedbackButton.setAttribute("project","nzs6xodw4b"),feedbackButton.setAttribute("modal-position","bottom-right"),feedbackButton.setAttribute("button-style","light"),feedbackButton.setAttribute("button-position","bottom-right"),feedbackButton.setAttribute("id","default"),feedbackButton.textContent="Feedback",document.body.appendChild(feedbackButton)</script></body>
</html>