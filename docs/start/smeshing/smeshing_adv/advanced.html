<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-start/smeshing/smeshing_adv/advanced" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Additional Advanced Topics | Spacemesh Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacemesh.io/docs/start/smeshing/smeshing_adv/advanced"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="X71PuqeyvYyDQE1_3384Aml425A-ZELYBf7-ZfFRUoY"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Additional Advanced Topics | Spacemesh Documentation"><meta data-rh="true" name="description" content="Monitoring"><meta data-rh="true" property="og:description" content="Monitoring"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.spacemesh.io/docs/start/smeshing/smeshing_adv/advanced"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/start/smeshing/smeshing_adv/advanced" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/start/smeshing/smeshing_adv/advanced" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OGGMN1SAN3-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2CL6HG3B96"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2CL6HG3B96",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Spacemesh Documentation" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.css"><link rel="stylesheet" href="/assets/css/styles.a7d2cb45.css">
<link rel="preload" href="/assets/js/runtime~main.cd992366.js" as="script">
<link rel="preload" href="/assets/js/main.7fb6dc6c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/learn/spacemesh">Explainers</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/start/smeshing/start">Guides</a><a href="https://mainnet-api-docs.spacemesh.network/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/start/smeshing/start">Smeshing Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/start">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/requirements">System Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/considerations">Practical Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/netconfig">Network Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/start/smeshing/smeshing_basic/install">Basic Smeshing Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/start/smeshing/smeshing_adv/setup">Advanced Smeshing Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/setup">Advanced Smeshing Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/post_init">PoST Initialization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/api">API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/poet">PoET Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/networking">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/performance">Fine-Tuning Node Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/equivocation">Avoiding Equivocation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/verification">State Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/quicksync">Quicksync</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/start/smeshing/smeshing_adv/advanced">Additional Advanced Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/post_1n">Managing Multiple PoST Services on A Single Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/multigpu">Initializing a Subset of PoST Data With postcli</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start/smeshing/smeshing_adv/troubleshooting">Troubleshooting</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/start/rewards">How Rewards Work</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/start/integration">Integration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/start/ledger">Ledger Guide</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Smeshing Guide</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Advanced Smeshing Guide</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Additional Advanced Topics</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Additional Advanced Topics</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">​</a></h2><p>The simplest and most straightforward way to monitor any running node, including a mining node, is by using the <a href="/docs/start/smeshing/smeshing_adv/api">gRPC API</a>. You can use the <code>spacemesh.v1.NodeService.Status</code> gRPC command to see the current status (number of connected peers, sync status, and layer status), and you can use the <code>spacemesh.v1.AdminService.EventsStream</code> command to follow events (such as proof creation and broadcast, eligibilities, etc.) (see <a href="/docs/start/smeshing/smeshing_adv/api">API</a> for example commands).</p><p>It is also possible to do more sophisticated monitoring using <a href="https://prometheus.io/docs/visualization/grafana/" target="_blank" rel="noopener noreferrer">Prometheus and Grafana</a>. You can configure your own Prometheus data model, or use the out-of-box model that <code>go-spacemesh</code> already supports. If you run the node with the <code>--metrics</code> flag (or set this in the <a href="/docs/start/smeshing/smeshing_adv/setup#configuring-the-node">config</a>), and optionally <code>--metrics-port</code>, then Prometheus can scrape metrics from the running node.</p><p>You can find community-contributed examples of both of these in <a href="https://github.com/lrettig/awesome-spacemesh/blob/main/README.md#monitoring" target="_blank" rel="noopener noreferrer">this list</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="increasing-and-decreasing-storage">Increasing and Decreasing Storage<a href="#increasing-and-decreasing-storage" class="hash-link" aria-label="Direct link to Increasing and Decreasing Storage" title="Direct link to Increasing and Decreasing Storage">​</a></h2><p>This topic is covered in the <a href="/docs/start/smeshing/smeshing_adv/post_init#resizing-post">PoST Initialization</a> section.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="very-large-identities">Very Large Identities<a href="#very-large-identities" class="hash-link" aria-label="Direct link to Very Large Identities" title="Direct link to Very Large Identities">​</a></h2><p>In general, a smesher is free to initialize as much or as little storage as they like. However, smeshers with especially large identities may run into problems with <a href="/docs/start/smeshing/smeshing_adv/post_init#proof-generation">PoST generation</a> as this requires sequentially reading all of the PoST data and additionally doing proof of work over the data. In the worst case, if the user selects a relatively low number of nonces (see the next section), the node may get unlucky and may need to perform this sequential read multiple times. All of this needs to fit into the PoET <a href="/docs/start/smeshing/smeshing_adv/poet#timing">cycle gap</a> (12 hours for the mainnet). Otherwise, the smesher risks being ineligible for an entire epoch and missing all epoch rewards.</p><p>Precisely calculating the maximum identity size that a system can support depends upon a number of variables: drive read speed, CPU power, the other applications running on the system, and the configured parameters (see next section). As a rule of thumb, we recommend that smeshers not use identities larger than about 4 TiB (i.e., 64 SUs). Given the average hard drive read speed, and assuming the smesher is running on a reasonably powerful system, a smesher with a 4 TiB identity should have ample time to read that identity twice, if necessary, and successfully generate a proof during the cycle gap in the vast majority of cases. It should also be noted that advanced smeshers have reported achieving significantly higher throughput speeds and, thus, being able to manage much larger identities using, e.g., large NVMe SSD drives and/or <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_5" target="_blank" rel="noopener noreferrer">RAID5</a> configurations.</p><p>For very large identities, it probably makes sense to split the identity into multiple smaller identities (again, 4 TiB is a good starting point, although the exact amount will depend upon the system and the smesher&#x27;s needs). Assuming these identities are stored on physically separate disks, and assuming the smesher has a system that is powerful enough to run multiple nodes (i.e., the system resources are a multiple of the <a href="/docs/start/smeshing/requirements">required resources</a> for a single node), they should have no trouble running multiple identities on a single system.</p><p>You may find math such as the following helpful: assuming you know the throughput (based on drive read speed and CPU hash throughput), it should take <a href="https://www.wolframalpha.com/input?i=4TiB%2F%5B150MB%2Fsec%5D" target="_blank" rel="noopener noreferrer">a little over eight hours</a> to create a proof serially for a single 4TiB identity assuming a throughput of 150MB/s (normal for a modern HDD). Note that in this case, if the number of nonces is not high enough (see next section) and the proof generation fails in the first pass, there will not be enough time to perform a second pass during the 12-hour cycle gap!</p><p>Such a smesher should pay close attention to the contents of the <a href="#fine-tuning-proving">Fine-Tuning Proving</a> and <a href="#identity-management">Identity Management</a> sections, as they will need to generate and manage multiple identities, being sure to keep them separate and distinct and to <a href="#avoiding-equivocation">avoid equivocation</a>, and also to pick the appropriate proving parameters for her setup.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fine-tuning-proving">Fine-Tuning Proving<a href="#fine-tuning-proving" class="hash-link" aria-label="Direct link to Fine-Tuning Proving" title="Direct link to Fine-Tuning Proving">​</a></h2><p>As a refresher, there are two stages to the process of proving storage so that a smesher will be eligible for rewards on an ongoing basis: the <a href="#post-initialization-2">PoST initialization</a>, which only needs to be performed once, and the ongoing, regular <a href="#proofs-of-spacetime">proofs of spacetime</a> that smeshers need to generate and broadcast each epoch. Generating a proof of spacetime requires that the smesher perform a sequential read of all of their PoST data. Since it would be infeasible to transmit <em>all</em> of the PoST data as a proof, in order to make the proofs succinct, Spacemesh instead requires smeshers to do a small proof of work each epoch by hashing their PoST data and looking for elements (known as <strong>labels</strong>) that pass a certain proof of work threshold. The proof itself consists of just the indices of the labels that pass the threshold.</p><p>The user may specify the number of CPU threads and nonces that are used in the proving process. The process itself is probabilistic: with 64 nonces the probability of creating a successful proof in a single pass is 79.39%; with 128 nonces it is 95.75%; and with 288 nonces it is 99.9%. Moreover, the number of CPU threads must be set to balance disk read speed. For more information on this process, see <a href="https://community.spacemesh.io/t/proof-of-work-and-post-proof-generation/361" target="_blank" rel="noopener noreferrer">Proof of work and PoST proof generation</a> in the Spacemesh research forum.</p><p>As described in the <a href="/docs/start/smeshing/smeshing_adv/setup#configuring-the-node">config</a> section, these parameters can be passed to <code>postcli</code> (as command-line arguments) and <code>go-spacemesh</code> (command-line arguments or via the config file). Advanced smeshers will need to run some benchmarks to determine the best values for their particular system. See the documentation for <a href="https://github.com/spacemeshos/post-rs/blob/main/docs/profiler.md" target="_blank" rel="noopener noreferrer">the profiler tool</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="identity-management">Identity Management<a href="#identity-management" class="hash-link" aria-label="Direct link to Identity Management" title="Direct link to Identity Management">​</a></h2><p>Each smesher in Spacemesh has an identity, known as a smesher ID or smesher ID. The ID is simply a 32-byte Ed25519 public key, which is commonly displayed in hexadecimal or base64 format. It should look something like <code>0x91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</code> (hex) or <code>kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=</code> (base64).</p><p>Note: smesher identities have absolutely nothing to do with accounts or wallet addresses. Both are based on Ed25519 keypairs, but that is all they have in common. A smesher also needs to specify a coinbase account to receive its rewards, but that coinbase account is not derived from the smesher identity nor connected to it in any way. It can also be changed at any time. The smesher identity <strong>is connected</strong> to its PoST data, however. PoST data generated for a given smesher ID can never be used by another smesher. Moreover, if a smesher identity is lost or invalidated for equivocation, the associated PoST data becomes useless.</p><p>Tip: You can convert between these two formats using two simple command-line tools:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xxd -r -p </span><span class="token operator">|</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> base64 -d </span><span class="token operator">|</span><span class="token plain"> xxd -p -c </span><span class="token number">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first time the node runs, it will create a new smesher identity (if it does not see an existing one), which it stores in a file <code>&lt;data dir&gt;/identities/local.key</code>, by default <code>~/spacemesh/identities/local.key</code>. This file contains both the smesher public and private keys. The private key is used to sign messages on behalf of the smesher. <strong>It is critical that this file be kept private (its contents should never be revealed or sent to anyone) and that it not be lost</strong>. If it is lost, just like a lost wallet there is absolutely no way to restore it, and the associated PoST data would become useless.</p><p>You can read the public key portion of the key file, i.e., the hexadecimal smesher identity, as follows:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cut</span><span class="token plain"> -c </span><span class="token number">65</span><span class="token plain">-128 local.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also read the identity from a running node via the API:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; grpcurl -plaintext localhost:9093 spacemesh.v1.SmesherService.SmesherID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;publicKey&quot;: &quot;kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A smesher identity can be transferred from one system to another simply by moving the <code>local.key</code> file. However, it is essential that the same identity never be attached to two running smeshers at the same time in order to avoid equivocation (see next section).</p><p>A new identity can be generated by deleting or moving the <code>local.key</code> file and starting the node again, at which point a new identity will be created. <code>postcli</code> can be used to do the same thing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="moving-post-files">Moving PoST Files<a href="#moving-post-files" class="hash-link" aria-label="Direct link to Moving PoST Files" title="Direct link to Moving PoST Files">​</a></h2><p>You can safely move PoST data from one directory to another, or from one system to another, as long as the data remains intact and you are careful to avoid equivocation (see next point). The smesher identity used to create the PoST data is bound with the data and, thus, you must move the <code>local.key</code> file along with the rest of the data. The data is useless without the <code>local.key</code> identity file, and any attempt to use the same PoST data with a different smesher identity will fail. There is nothing about the data that ties it to a particular system, architecture, or operating system. Thus, it is also safe to move the data across systems.</p><p>We strongly recommend using a tool like <a href="https://www.digitalocean.com/community/tutorials/how-to-use-rsync-to-sync-local-and-remote-directories" target="_blank" rel="noopener noreferrer">rsync</a>, which has built-in error checking and can resume a partial transfer, to move data both locally and remotely. You can use a command like the following to move data locally:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -avhz --progress /source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use a command like the following to copy data from a remote host:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -avhz --progress user@hostname:/source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(Note the use of trailing slashes: rsync is particular about these, and adding or removing a trailing slash can have unintended consequences.)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-drives">Multiple Drives<a href="#multiple-drives" class="hash-link" aria-label="Direct link to Multiple Drives" title="Direct link to Multiple Drives">​</a></h2><p>At present it is not possible to naively split a single identity across multiple drives or filesystems. We hope to add this feature soon. In the meantime you have two possibilities: run multiple identities, or join multiple filesystems into a single logical filesystem at the hardware or OS level.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-identities">Multiple Identities<a href="#multiple-identities" class="hash-link" aria-label="Direct link to Multiple Identities" title="Direct link to Multiple Identities">​</a></h3><p>Running multiple identities is explained in <a href="#identity-management">Identity Management</a> and <a href="#multiple-nodes">Multiple Nodes</a>. This has the advantage that you do not need to mess with your filesystem configuration at all, and that you can <a href="#post-initialization-2">initialize</a> and <a href="#proof-generation">generate proofs</a> for each identity more easily in parallel. It has the downside that you need to run multiple nodes, which will consume multiples of the <a href="#requirements">required resources</a> that a single node consumes. Also, since it is in the interest of the network to reduce the number of identities as much as possible, we will be adding incentives for larger ATXs (generated by larger identities) and disincentives for many small ATXs. Please bear this in mind when you decide how many identities to run.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="joining-filesystems">Joining Filesystems<a href="#joining-filesystems" class="hash-link" aria-label="Direct link to Joining Filesystems" title="Direct link to Joining Filesystems">​</a></h3><p>There are many ways to combine multiple, physical filesystems into a single &quot;logical&quot; filesystem and the best way to do this will depend on your hardware, your operating systems, your degree of technical expertise, and your needs. Some smeshers have had success with <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_5" target="_blank" rel="noopener noreferrer">RAID5</a>. Bear in mind that it is possible to run RAID in either <a href="https://www.techtarget.com/searchstorage/tip/Key-differences-in-software-RAID-vs-hardware-RAID" target="_blank" rel="noopener noreferrer">hardware or software</a>, with various tradeoffs. Linux users can rely on <a href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_(Linux)" target="_blank" rel="noopener noreferrer">LVM</a>, which has wide support in modern distributions.</p><p>This has the advantage that you can run a single node, rather than many, and that, if configured correctly, you may achieve much faster read speed (see <a href="#very-large-identities">Very Large Identities</a>) than you can with a single drive. It has the disadvantage of requiring more configuring at the operating system and filesystem level. Smeshers who are not comfortable doing so may prefer to instead run multiple identities.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-management">State Management<a href="#state-management" class="hash-link" aria-label="Direct link to State Management" title="Direct link to State Management">​</a></h2><p>The node stores all of the network state in a <a href="https://www.sqlite.org/index.html" target="_blank" rel="noopener noreferrer">SQLite</a> database called <code>state.sql</code> (along with a couple of auxiliary files) in the node&#x27;s data directory:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -1 data/7c8cef2b/state.*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql-shm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql-wal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It is possible to explore the contents of this database to understand a node&#x27;s view of the network, especially when the desired data is not available via the API. First, two important notes about working with the state database:</p><p><strong>Note 1: Unlike the API, we make no guarantees that the state database schema will remain the same.</strong> It will likely evolve over time. Thus, while it is perfectly okay to explore the state database for troubleshooting, we strongly recommend against building or deploying any production applications that rely on it.</p><p><strong>Note 2: Never, under any circumstances, modify the state of a running node.</strong> Making even a small change runs the risk of totally corrupting the state database, which in the worst case would require that a node be resynced from scratch, a process that can take a long time (and during which time a smesher node is not eligible for rewards). As such, before even opening the state database, <strong>make a copy of the file</strong> and work with the copy only to make sure you do not accidentally modify the live database.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reading-the-state-database">Reading the State Database<a href="#reading-the-state-database" class="hash-link" aria-label="Direct link to Reading the State Database" title="Direct link to Reading the State Database">​</a></h3><p>There are multiple ways to read data from a SQLite database. We recommend either using the official <a href="https://sqlite.org/cli.html" target="_blank" rel="noopener noreferrer"><code>sqlite3</code></a> program, or else the cross-platform, open source UI alternative <a href="https://sqlitebrowser.org/" target="_blank" rel="noopener noreferrer">DB Browser</a>. If you open the state database in the DB Browser you should see something like the following:</p><p><img loading="lazy" src="https://github.com/spacemeshos/wiki/assets/3316532/ad3eb4f3-af7b-49eb-8842-f46fe707f545" alt="image" class="img_ev3q"></p><p>The full extent of queries you can run against this database is beyond the scope of this document, but as a simple example, here is how you&#x27;d look up the coinbase associated with a given smesher, and thus find that smesher&#x27;s rewards using the coinbase:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTINCT</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">coinbase</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> atxs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;F353545DB955F5A359F406ACAB847408D40530A6782BE436553FE521033A42EC&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">000000006</span><span class="token plain">EE7C594D665EABFD653CF6920C7E24A3B8562C7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> layer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> total_reward </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> rewards </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">coinbase</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;000000006EE7C594D665EABFD653CF6920C7E24A3B8562C7&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">8090</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">266137048118</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="backing-up-state">Backing Up State<a href="#backing-up-state" class="hash-link" aria-label="Direct link to Backing Up State" title="Direct link to Backing Up State">​</a></h3><p>It can be helpful to create snapshots or backup versions of a node&#x27;s state so that data may be restored more quickly in case of corruption or failure (rather than needing to resync from scratch, which is time-consuming). This process is very straightforward: just create a copy of the files shown above, i.e., the <code>state.*</code> files inside the node&#x27;s data directory.</p><p>Due to SQLite&#x27;s <a href="https://www.sqlite.org/atomiccommit.html" target="_blank" rel="noopener noreferrer">atomic commit</a> feature it should not be necessary to stop the node before taking a snapshot, but if you want to be extra careful you may do so. Also, note that <a href="https://serverfault.com/questions/307296/which-filesystems-offer-snapshot-functionality-for-users-to-recover-data" target="_blank" rel="noopener noreferrer">certain filesystems</a> make snapshotting easier or even automatic.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clearing-state">Clearing State<a href="#clearing-state" class="hash-link" aria-label="Direct link to Clearing State" title="Direct link to Clearing State">​</a></h3><p>From time to time, such as if the state database becomes corrupt or if you simply want to resync your node from genesis, it becomes necessary to clear the state entirely. In order to do this, you should:</p><ol><li>Stop the node. Ensure that it is exited cleanly and completely.</li><li>Remove the files shown above, i.e., the <code>state.*</code> files inside the node&#x27;s data directory. Note: do not remove the other contents of the data directory as it also contains, e.g., P2P data.</li><li>Restart the node. You should see it begin to sync from genesis.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="copying-state">Copying State<a href="#copying-state" class="hash-link" aria-label="Direct link to Copying State" title="Direct link to Copying State">​</a></h3><p>There is no &quot;private&quot; data, i.e., data that is specific to one smesher or one node, in the state database. This means that you can copy one trusted node&#x27;s database to another node as a quick-and-dirty &quot;quick sync&quot; option, rather than letting the nodes sync the old-fashioned way. To do this:</p><ol><li>Make sure both nodes are running the same version of go-spacemesh.</li><li>Stop <strong>both nodes.</strong> Ensure that they&#x27;ve exited cleanly and completely.</li><li>Remove the state files entirely from node B, i.e., the destination node, by following the instructions above.</li><li>Copy the same files, i.e., the <code>state.*</code> files inside the data directory of node A (i.e., the source node) to the data directory of node B. It is safe to do this from one system to another even if the two systems are on different architectures or different operating systems.</li><li>Restart both nodes.</li></ol><p>Note: by directly copying the state database you bypass the protections in the protocol and the node that would prevent your node from accepting bad state or bad transactions. For this reason, it is essential that you <strong>only copy the state from a trusted node,</strong> i.e., a node that you run yourself, and that you <strong>never blindly accept state data from a third party.</strong> Otherwise, you may end up with corrupt or incorrect state.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-management">Log Management<a href="#log-management" class="hash-link" aria-label="Direct link to Log Management" title="Direct link to Log Management">​</a></h2><p>Smapp automatically manages logs for a running node: it compresses and rotates logfiles when they grow large. The node log appears in the Smapp data directory:</p><ul><li><code>~/Library/Application Support/Spacemesh</code> on macOS</li><li><code>~/.config/Spacemesh</code> on Linux</li><li><code>~\AppData\Roaming\Spacemesh</code> on Windows</li></ul><p>If you are running <code>go-spacemesh</code> directly, you are responsible for log management. As described above, we strongly recommend running the node as a <a href="#system-service">system service</a> on your operating system. Different operating systems and different service managers have different ways of managing logs. You can read about <a href="https://www.loggly.com/ultimate-guide/linux-logging-with-systemd/" target="_blank" rel="noopener noreferrer">how Systemd manages journals on Linux</a>, for example.</p><p>You may find a command such as the following helpful to both display the running node logs and also save them to a file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> go-spacemesh -c config-file.json </span><span class="token operator">|&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> logfile.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One more note about logs: by default, the log level is set to <code>INFO</code> for all node services, in order to keep logfiles manageable. Setting the log level to <code>DEBUG</code> for one or more services can be helpful for troubleshooting. You can accomplish this by adding a <code>logging</code> section to your config file, as such:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;logging&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;atxBuilder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;block-builder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;block-listener&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;nipostBuilder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;poet&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;post&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;p2p&quot;: &quot;error&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For the full list of services, see <a href="https://github.com/spacemeshos/go-spacemesh/blob/develop/config/logging.go" target="_blank" rel="noopener noreferrer"><code>config/logging.go</code></a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="post-metadata">PoST Metadata<a href="#post-metadata" class="hash-link" aria-label="Direct link to PoST Metadata" title="Direct link to PoST Metadata">​</a></h2><p>The PoST data directory contains a file called postdata_metadata.json that contains metadata related to the identity and data files:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; cat ~/post/7c8cef2b/postdata_metadata.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NodeId&quot;: &quot;3hcrKr45D5H8GrRikkZMztvKjvQpviUwVqRVMgh0jqk=&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;CommitmentAtxId&quot;: &quot;nuv/Ajq7F8y3dcYC2q3o7XCPClDTFJpCgBGE9bdPKGU=&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;LabelsPerUnit&quot;: 4294967296,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NumUnits&quot;: 15,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;MaxFileSize&quot;: :4294967296,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;Nonce&quot;: 34659695032,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NonceValue&quot;: &quot;0000000006db3dc6d84ff41b8acb588d&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In general, you should never touch this file or change any of these values, other than when combining data from a <a href="#parallel-initialization">parallel initialization</a>, which requires manually finding the lowest nonce.</p><p>It is <em>never safe</em> to change the <code>NodeId</code>, <code>CommitmentAtxId</code>, <code>LabelsPerUnit</code>, or <code>MaxFileSize</code> values. If you increase <code>MaxUnits</code> and run <code>postcli</code> or <code>go-spacemesh</code>, it will continue PoST initialization and generate more files. This is safe to do unless/until your smesher has already generated and broadcast an ATX, after which it cannot be changed. If you decrease <code>MaxUnits</code> and run <code>postcli</code> or <code>go-spacemesh</code>, they will delete existing files to match the config value.</p><p>It is always safe to change the <code>Nonce</code> and <code>NonceValue</code> to any valid values, even after generating and broadcasting an ATX. If, for instance, you discover that you had not configured the lowest nonce, you can add it later. Note that this will have no impact on rewards. It is just future-proofing in case you change the PoST size in the future (once this is allowed). See <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli#searching-for-a-lost-vrf-nonce" target="_blank" rel="noopener noreferrer">Searching for a lost VRF nonce</a>.</p><p>Note that this nonce value, known as a VRF Nonce, has nothing to do with the nonce value <a href="#fine-tuning-proving">used in proving</a>. The VRF Nonce is used to help determine when your node is eligible to participate in block proposal and the Tortoise beacon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-gpu">Cloud GPU<a href="#cloud-gpu" class="hash-link" aria-label="Direct link to Cloud GPU" title="Direct link to Cloud GPU">​</a></h2><p>Smeshers without local access to a GPU may choose to instead perform GPU initialization remotely using one or multiple (see next section) GPUs. This can be done using the infrastructure of any cloud compute provider that offers a modern GPU platform. Note that cloud providers that specialize in GPUs and other types of high-performance computing will often offer better prices and tooling than general-purpose cloud compute platforms like Azure, AWS, or GCP. While we cannot vouch for any particular provider and have no affiliation with any such provider, in our testing we&#x27;ve had particular luck with <a href="https://www.runpod.io/" target="_blank" rel="noopener noreferrer">Runpod</a> and have also heard good things about <a href="https://www.coreweave.com/" target="_blank" rel="noopener noreferrer">Coreweave</a> and <a href="https://vast.ai/" target="_blank" rel="noopener noreferrer">Vast</a>.</p><p>As a rule of thumb, you will want access to an instance that:</p><ul><li>has a modern GPU (e.g., RTX 3090 or 4090. See <a href="#post-initialization-1">Requirements: PoST Initialization</a>).</li><li>has plenty of storage, around 10% more than you plan to initialize (e.g., if you plan to initialize 1 TiB of PoST storage, we recommend choosing an instance with at least 1.1 TiB).</li><li>has a very fast Internet connection with plenty of bandwidth.</li><li>does not charge a lot for data egress.</li></ul><p>Most GPU providers simply run a docker container for you. You may find <a href="https://hub.docker.com/r/lrettig/nvidia-opencl" target="_blank" rel="noopener noreferrer">this barebones image</a> useful. You can use it as <code>docker.io/lrettig/nvidia-opencl:latest</code> in a cloud host, and you can find the <a href="https://github.com/lrettig/spacemesh-nvidia-opencl/blob/main/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile here</a>. It simply installs the packages required for OpenCL on Ubuntu and then downloads <a href="https://github.com/spacemeshos/post/releases" target="_blank" rel="noopener noreferrer"><code>postcli</code></a>. Here is <a href="https://github.com/smeshcloud/nvidia-cuda-opencl/blob/main/Dockerfile" target="_blank" rel="noopener noreferrer">an alternative</a>.</p><p>Bear in mind that generating the PoST files is only half the battle. You also need to download them! Some providers charge a lot for data egress, which can get expensive quickly when downloading many terabytes of data. And, in order to move the data in a reasonable amount of time, you will want to find a cloud instance with plenty of bandwidth, ideally more than 1gbit/sec. Any slower than this and you will wait forever to download the files. Be wary of &quot;community&quot; run nodes on cloud marketplaces such as Runpod and Vast since while they may be cheaper these often do not have the requisite bandwidth.</p><p>As <a href="#moving-post-files">described above</a>, we recommend using a utility like rsync with features such as error checking and resuming to download files. rsync works well as long as you have <code>ssh</code> access to the cloud host. Here is a sample rsync command that uses an ssh identity file and connects to a particular remote port:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ssh -i ~/.ssh/id_ed25519 -p 22164&quot;</span><span class="token plain"> -avhz --progress user@host:/source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Remember that you can begin downloading the PoST data files before initialization is complete! Just run rsync again after it finishes or, better yet, run it in an automatic loop to maximize efficiency:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ssh -i ~/.ssh/id_ed25519 -p 22164&quot;</span><span class="token plain"> -avhz --progress user@host:/source/directory/ /destination/directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sleep</span><span class="token plain"> </span><span class="token number">300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="feedback-widget margin-top--md margin-bottom--md"><div class="margin-bottom--sm"><b>Was this helpful?</b></div><span class="feedback-widget-positive"><feedback-button project="nzs6xodw4b" rating="1" custom-font="True" button-style="default" modal-position="center"><button class="button button--outline button--primary button--sm" title="Yes"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg></button></feedback-button></span><span class="feedback-widget-negative margin-left--sm"><feedback-button project="nzs6xodw4b" rating="0" custom-font="True" button-style="default" modal-position="center"><button class="button button--outline button--primary button--sm" title="No"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path></svg></button></feedback-button></span></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/spacemeshos/docs/edit/main/docs/start/smeshing/smeshing_adv/advanced.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/start/smeshing/smeshing_adv/quicksync"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quicksync</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/start/smeshing/smeshing_adv/post_1n"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Managing Multiple PoST Services on A Single Node</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li><li><a href="#increasing-and-decreasing-storage" class="table-of-contents__link toc-highlight">Increasing and Decreasing Storage</a></li><li><a href="#very-large-identities" class="table-of-contents__link toc-highlight">Very Large Identities</a></li><li><a href="#fine-tuning-proving" class="table-of-contents__link toc-highlight">Fine-Tuning Proving</a></li><li><a href="#identity-management" class="table-of-contents__link toc-highlight">Identity Management</a></li><li><a href="#moving-post-files" class="table-of-contents__link toc-highlight">Moving PoST Files</a></li><li><a href="#multiple-drives" class="table-of-contents__link toc-highlight">Multiple Drives</a><ul><li><a href="#multiple-identities" class="table-of-contents__link toc-highlight">Multiple Identities</a></li><li><a href="#joining-filesystems" class="table-of-contents__link toc-highlight">Joining Filesystems</a></li></ul></li><li><a href="#state-management" class="table-of-contents__link toc-highlight">State Management</a><ul><li><a href="#reading-the-state-database" class="table-of-contents__link toc-highlight">Reading the State Database</a></li><li><a href="#backing-up-state" class="table-of-contents__link toc-highlight">Backing Up State</a></li><li><a href="#clearing-state" class="table-of-contents__link toc-highlight">Clearing State</a></li><li><a href="#copying-state" class="table-of-contents__link toc-highlight">Copying State</a></li></ul></li><li><a href="#log-management" class="table-of-contents__link toc-highlight">Log Management</a></li><li><a href="#post-metadata" class="table-of-contents__link toc-highlight">PoST Metadata</a></li><li><a href="#cloud-gpu" class="table-of-contents__link toc-highlight">Cloud GPU</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/teamspacemesh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/spacemeshos/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://spacemesh.io/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dash.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dashboard</a></li><li class="footer__item"><a href="https://explorer.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Spacemesh.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cd992366.js"></script>
<script src="/assets/js/main.7fb6dc6c.js"></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.esm.js"></script>
<script>const feedbackButton=document.createElement("feedback-button");feedbackButton.setAttribute("project","nzs6xodw4b"),feedbackButton.setAttribute("modal-position","bottom-right"),feedbackButton.setAttribute("button-style","light"),feedbackButton.setAttribute("button-position","bottom-right"),feedbackButton.setAttribute("id","default"),feedbackButton.textContent="Feedback",document.body.appendChild(feedbackButton)</script></body>
</html>