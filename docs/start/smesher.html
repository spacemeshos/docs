<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-start/smesher">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Smesher Guide | Spacemesh Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacemesh.io/docs/start/smesher"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Smesher Guide | Spacemesh Documentation"><meta data-rh="true" name="description" content="Resource requirements for mining in Spacemesh can be broken down into three categories: those for running a full node, which are required for all nodes regardless of whether or not they&#x27;re mining; those required for the PoST initialization process that&#x27;s required before mining starts; and those required for ongoing mining."><meta data-rh="true" property="og:description" content="Resource requirements for mining in Spacemesh can be broken down into three categories: those for running a full node, which are required for all nodes regardless of whether or not they&#x27;re mining; those required for the PoST initialization process that&#x27;s required before mining starts; and those required for ongoing mining."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.spacemesh.io/docs/start/smesher"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/start/smesher" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacemesh.io/docs/start/smesher" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OGGMN1SAN3-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Spacemesh Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Spacemesh Documentation Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Spacemesh Documentation" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.156c16b2.css">
<link rel="preload" href="/assets/js/runtime~main.0555323c.js" as="script">
<link rel="preload" href="/assets/js/main.82529be2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/learn/crypto">Learn About Spacemesh</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/start">Hands-On Guides</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/start">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/start/smesher">Smesher Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/start/smapp/install">Smapp</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/start/CLI/compiling">CLI</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Smesher Guide</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Requirements</h1><p>Resource requirements for mining in Spacemesh can be broken down into three categories: those for running a full node, which are required for all nodes regardless of whether or not they&#x27;re mining; those required for the PoST initialization process that&#x27;s required before mining starts; and those required for ongoing mining.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="full-node">Full Node<a href="#full-node" class="hash-link" aria-label="Direct link to Full Node" title="Direct link to Full Node">​</a></h2><p>See the official set of <a href="https://spacemesh.io/start/#system-requirements" target="_blank" rel="noopener noreferrer">system requirements &amp; recommended hardware</a>. Resource requirements for running a node are quite modest: an Intel or ARM CPU, a modern operating system, a few dozen GB of free hard disk space, and a reliable broadband Internet connection.</p><p>The biggest resource consumed by a Spacemesh node is bandwidth. A full node currently consumes between 150-1500mb/hour of bandwidth. The node is quiescent most of the time, consuming only 100-300kbit/s, but spikes as high as 35Mbit/s every few minutes when a new layer appears and network traffic increases (Hare messages, proposals, etc.). Bandwidth is variable and depends heavily on the network condition and the number and quality of one&#x27;s peers.</p><p>It&#x27;s important that a node be run on an <strong>unmetered Internet connection</strong> or bandwidth charges will add up quickly.</p><p>We have plans to drastically reduce bandwidth consumption via a more efficient Hare protocol and other improvements, but these upgrades aren&#x27;t finished and aren&#x27;t scheduled yet.</p><p>As of epoch 5, a full node requires around 1.6gb to store the state database (note that versions of <code>go-spacemesh</code> prior to v1.2.0 consumed significantly more hard disk space). We strongly recommend storing the node state (i.e., the <code>data-folder</code>) on a fast drive such as a SSD, as opposed to a HDD, to ensure that disk throughput doesn&#x27;t limit the node&#x27;s ability to keep up with the network.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="post-initialization">PoST Initialization<a href="#post-initialization" class="hash-link" aria-label="Direct link to PoST Initialization" title="Direct link to PoST Initialization">​</a></h2><p>PoST init is designed to be done with a GPU. It can be done with a CPU, but it will be orders of magnitude slower. The newer and faster the GPU, the faster the initialization process.</p><p>As a benchmark, the minimum PoST data size (256GiB, or 4 storage units) can be initialized in 8-10 hours using a single Nvidia GeForce RTX 4090. The same data would take around 36 hours using a Nvidia GeForce RTX 3060. Initialization time scales linearly, so that initializing 40 SU would take 10x as long as initializing 4 SU.</p><p>Note that initialization can be parallelized across multiple systems or multiple GPUs, and it can be performed on one system (including in the cloud) and the resultant data moved to another system (e.g., one without a GPU) for long-term storage and mining. There&#x27;s more information on this below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ongoing-mining">Ongoing Mining<a href="#ongoing-mining" class="hash-link" aria-label="Direct link to Ongoing Mining" title="Direct link to Ongoing Mining">​</a></h2><p>Mining on an ongoing basis does <em>not</em> require a GPU. The only additional resource consideration for mining, beyond the baseline cost of running a full node (as outlined above), is the cost of generating a <a href="#proof-of-space">proof of space</a> once per epoch. The time required to generate a proof is complicated and multivariate, depending on several factors including CPU speed, disk speed, size of PoST data, and the <code>smeshing-proving-opts</code> settings specified in config (more on this below).</p><p>The general requirement is a modern CPU with the <a href="https://en.wikipedia.org/wiki/AES_instruction_set" target="_blank" rel="noopener noreferrer">AES-NI</a> instruction and a disk that&#x27;s fast enough to perform a single, sequential read over the entire PoST data in 4-5 hours. This allows enough time to perform a second read during the PoET cycle gap on the off chance that the first pass fails to generate a valid proof. Hard drive performance varies widely but most modern 7200 RPM HDDs can perform a sequential read at 100-200mb/sec (5400 RPM drives are slower). This means that, to be safe, a smesher shouldn&#x27;t initialize more than 2-4 TB or 8-16 SU on a single HDD. It&#x27;s certainly possible to initialize more and smeshers with 4TB drives and fast CPUs report no issues generating a proof in time, but the probability of failure increases with each additional byte initialized. It&#x27;s also possible to achieve much higher read speeds using more expensive technology such as SSD and/or RAID.</p><p>For much more information see <a href="#fine-tuning-proving">fine-tuning proving</a> and <a href="https://github.com/spacemeshos/post-rs/blob/main/docs/profiler.md" target="_blank" rel="noopener noreferrer">the profiler tool</a> which can be used to benchmark one&#x27;s hardware.</p><h1>Getting Started</h1><p>Now that you have the necessary resources ready, it&#x27;s time to start smeshing! This section will walk you through how to do that. First a couple quick notes:</p><ul><li>this guide is intended as an advanced smeshing guide, covering cases such as smeshing using CLI, parallel init, cloud GPUs, and transferring and managing multiple identities. In particular it does not cover the baseline case of using Smapp to initialize a single smesher. That process is straightforward and mostly automated in Smapp, and the steps are outlined in this <a href="https://youtu.be/xwsg7FzuBE0?si=Eing6i_KY7VSE7W4" target="_blank" rel="noopener noreferrer">explainer video</a>. The guide does explain the differences between mining using Smapp or the CLI where appropriate.</li><li>the author of this guide uses Linux and CLI commands will be specified as they&#x27;d be run on Linux. In most cases, the same commands should work verbatim on other platforms including Windows and macOS with appropriate tweaks (e.g., using the correct platform-specific paths). Contributions containing correct instructions for different platforms are welcome; feel free to <a href="https://github.com/spacemeshos/wiki/issues" target="_blank" rel="noopener noreferrer">open an issue</a> with a contribution.</li></ul><h1>Running a Node</h1><p>In order to mine one must have a fully synchronized Spacemesh node running. Strictly speaking, running a node is not required during the PoST initialization process, since it relies only upon static data (with one exception, explained in a moment) such as the smesher&#x27;s identity and the PoST init params (total storage to initialize, max file size, etc.). Most smeshers nevertheless choose to run a full node throughout the init process for several reasons: the node itself can perform the initialization for you, it means you&#x27;ll have a fully-synchronized node when the init finishes and smeshing begins (with the opportunity to troubleshoot any issues in the interim), and it means you&#x27;ll have a trustless copy of the highest <code>commitmentAtxId</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="commitmentatxid"><code>commitmentAtxId</code><a href="#commitmentatxid" class="hash-link" aria-label="Direct link to commitmentatxid" title="Direct link to commitmentatxid">​</a></h2><p>The one piece of dynamic data that you need to perform PoST init is the highest <code>commitmentAtxId</code>. This is simply the ID of the highest ATX known at the time that PoST initialization begins. It&#x27;s used to mitigate a certain class of protocol attack; for more information, see <a href="https://github.com/spacemeshos/pm/issues/172" target="_blank" rel="noopener noreferrer">POPS-VRF implementation</a>.</p><p>The simplest way to get this is to ask your own node, using the API as such:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext </span><span class="token number">127.0</span><span class="token plain">.0.1:9092 spacemesh.v1.ActivationService.Highest </span><span class="token operator">|</span><span class="token plain"> jq -r </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.atx.id.id&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> base64 -d </span><span class="token operator">|</span><span class="token plain"> xxd -p -c </span><span class="token number">64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">435fa442517e9c75087de1b06d2a9d12c345505f3cac93ac52b816171ce48308</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>While we plan to operate public nodes in the near future, we don&#x27;t operate any at present. We therefore strongly encourage you to double-check this information, ideally by running your own node, or alternatively by checking with the community <a href="https://chat.spacemesh.io/" target="_blank" rel="noopener noreferrer">on Discord</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smapp">Smapp<a href="#smapp" class="hash-link" aria-label="Direct link to Smapp" title="Direct link to Smapp">​</a></h2><p>The simplest way to run a Spacemesh node is using <a href="https://github.com/spacemeshos/smapp/" target="_blank" rel="noopener noreferrer">Smapp</a>, the wallet, full node, and miner frontend application. You can simply download and install the <a href="https://github.com/spacemeshos/smapp/releases" target="_blank" rel="noopener noreferrer">latest release</a> for your platform and be up and running in no time. Smapp will automatically download the correct configuration file, and will show you visually the network status, its synchronization status, and the status of PoST init and smeshing. Smapp bundles a full go-spacemesh instance under the hood and manages it for you, including upgrades. See <a href="/docs/start/smapp/install">our smapp guide</a> for more information on setting up Smapp.</p><p>Like running go-spacemesh directly from the command line, Smapp also lets you customize your config file and use the node API directly. Running Smapp doesn&#x27;t provide any greater or lesser functionality than running go-spacemesh directly, but some technical users may prefer working with CLI rather than GUI, may wish to run go-spacemesh as a system service, etc. Users running without a GUI will of course have no choice but to run go-spacemesh directly via CLI.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-config">Custom config<a href="#custom-config" class="hash-link" aria-label="Direct link to Custom config" title="Direct link to Custom config">​</a></h3><p>While running Smapp, you should see two config files in the Smapp data directory (by default, <code>$HOME/.config/Spacemesh</code> on Linux):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -1 ~/.config/Spacemesh/node-config.*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/lane/.config/Spacemesh/node-config.7c8cef2b.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/lane/.config/Spacemesh/node-config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The second file, the one called <code>node-config.json</code>, is the default network config and should not be touched. (It should match the config available via the discovery service, see below.) The first file, the one called <code>node-config.7c8cef2b.json</code>, is your local copy of the config. (<code>7c8cef2b</code> is the genesis ID of the mainnet network. Config files for other networks will have different names.) You can modify this file if you first exit Smapp. Save your changes and open Smapp again to read them.</p><p>Note: use caution when modifying the config! This config file must currently maintain its structure. If you update, e.g., the subkey of an object, it&#x27;ll overwrite the entire object, not append it onto the main network config. See <a href="https://github.com/spacemeshos/smapp/issues/1407" target="_blank" rel="noopener noreferrer">Merge node config and custom config deeply</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-service">System Service<a href="#system-service" class="hash-link" aria-label="Direct link to System Service" title="Direct link to System Service">​</a></h2><p>On compatible Linux-based systems, we strongly recommend running <code>go-spacemesh</code> as a <a href="https://linuxhandbook.com/create-systemd-services/" target="_blank" rel="noopener noreferrer">systemd service</a>. This makes log management easier, and it ensures that the node will automatically restart if it dies or is killed, and that it automatically starts when the system is restarted. Each Linux distribution is different, so please check the documentation for your distribution to determine precisely where to create the service file. On most distributions the file should live in <code>/etc/systemd/system</code>. Here&#x27;s a sample service file - please read the <a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html" target="_blank" rel="noopener noreferrer">systemd documentation</a> for more information and update paths, users, etc. to suit your particular system:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description=go-spacemesh (Mainnet)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Wants=network-online.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">After=network-online.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">StartLimitIntervalSec=60</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">StartLimitBurst=5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User=spacemesh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group=spacemesh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Restart=always</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RestartSec=5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExecStart=go-spacemesh -c /home/spacemesh/node-config.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the service file in place, assuming it&#x27;s called <code>spacemesh.service</code>, you simply need to run the following commands to enable and start it:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl daemon-reload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> systemctl </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">enable</span><span class="token plain"> spacemesh.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can then view the logs of the running service by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> journalctl --unit spacemesh -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Wanted: Please add information on doing something similar on macOS and Windows.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api">API<a href="#api" class="hash-link" aria-label="Direct link to API" title="Direct link to API">​</a></h2><p>The node implements a <a href="https://grpc.io/" target="_blank" rel="noopener noreferrer">gRPC</a> API that can be used to monitor and interact with the running node, and change certain settings. The API is split into two separate instances, one public and one private, each of which implements several services that can be turned on or off at will. &quot;Public&quot; services provide readonly access to data such as node status, epochs/layers/blocks/transactions, account state, etc., whereas &quot;private&quot; services allow the operator to change the params of a running node, e.g., the <a href="https://github.com/spacemeshos/api/blob/a7c0b7acd9bc72940a8ab8e22202a77a4c3f438b/spacemesh/v1/smesher.proto#L29" target="_blank" rel="noopener noreferrer">smesher coinbase</a> or the <a href="https://github.com/spacemeshos/api/blob/a7c0b7acd9bc72940a8ab8e22202a77a4c3f438b/spacemesh/v1/smesher.proto#L55" target="_blank" rel="noopener noreferrer">set of PoET servers</a>. While &quot;public&quot; endpoints are theoretically safe to open for public API calls, in practice <strong>we strongly recommend that no API services be exposed publicly.</strong> The API design and implementation have not been hardened against denial of service attacks and represent an attack vector against a running node. For this reason, you should run <em>both the public and private API instances</em> on private interfaces (e.g., the loopback/127.0.0.1 interface) and/or put them behind a firewall.</p><p>Default network config files by default enable all API services:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;api&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;grpc-public-services&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;global&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;mesh&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;node&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;transaction&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;activation&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;grpc-public-listener&quot;: &quot;0.0.0.0:9092&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;grpc-private-services&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;smesher&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;admin&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;grpc-private-listener&quot;: &quot;127.0.0.1:9093&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;grpc-json-listener&quot;: &quot;0.0.0.0:9094&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that the public instance runs on the interface/port <code>0.0.0.0:9092</code> and the private runs on <code>127.0.0.1:9093</code>. <code>grpc-json-listener</code> refers to a JSON-based <a href="https://github.com/grpc-ecosystem/grpc-gateway" target="_blank" rel="noopener noreferrer">gRPC-Gateway</a> that allows clients that don&#x27;t speak gRPC to communicate with the API using JSON instead, and can in general be turned off.</p><p>The easiest way to interact with the API from the command line and from scripts is using the <a href="https://github.com/fullstorydev/grpcurl" target="_blank" rel="noopener noreferrer"><code>grpcurl</code></a> tool. gRPC is self-documenting via a feature known as <a href="https://github.com/grpc/grpc/blob/master/doc/server-reflection.md" target="_blank" rel="noopener noreferrer">reflection</a> that lets a client traverse an API, list RPC methods, inputs and outputs, and describe data types, e.g.:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext localhost:9092 list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.ActivationService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.DebugService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.GlobalStateService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.MeshService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.NodeService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.TransactionService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext localhost:9092 describe spacemesh.v1.NodeService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.NodeService is a service:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> NodeService </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc Build </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .google.protobuf.Empty </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.BuildResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc Echo </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.EchoRequest </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.EchoResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc ErrorStream </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.ErrorStreamRequest </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> stream .spacemesh.v1.ErrorStreamResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc NodeInfo </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .google.protobuf.Empty </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.NodeInfoResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc Status </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.StatusRequest </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.StatusResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc StatusStream </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.StatusStreamRequest </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> stream .spacemesh.v1.StatusStreamResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc Version </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .google.protobuf.Empty </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> returns </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> .spacemesh.v1.VersionResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext localhost:9092 describe spacemesh.v1.NodeInfoResponse</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh.v1.NodeInfoResponse is a message:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message NodeInfoResponse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string hrp </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint32 first_genesis </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint32 effective_genesis </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint32 epoch_size </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more information gRPC reflection see <a href="https://github.com/grpc/grpc-go/blob/master/Documentation/server-reflection-tutorial.md#enable-server-reflection" target="_blank" rel="noopener noreferrer">gRPC Server Reflection Tutorial</a>.</p><p>Common, useful commands for node operators include:</p><ul><li>Check node status (synced layer, verified layer, number of connected peers):</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext localhost:9092 spacemesh.v1.NodeService.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;status&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;connectedPeers&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;31&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;isSynced&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> true,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;syncedLayer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16278</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;topLayer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16278</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;verifiedLayer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16278</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>See the events stream (a useful, high level idea of what the node is doing, including PoST init, PoET registration, publishing ATXs, and publishing proposals):</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext localhost:9093 spacemesh.v1.AdminService.EventsStream</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-07T17:55:22.283848702Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Node computed randomness beacon, it will be used to determine eligibility to participate in the consensus.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;beacon&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;epoch&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;beacon&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nhiDhQ==&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-07T17:56:23.638117180Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Node started post data initialization. Note that init is noop if node restarted when init was ready.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initStart&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;smesher&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;...&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;commitment&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-07T17:56:23.664434458Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Node completed post data initialization.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;initComplete&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-07T17:56:23.686208298Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Node needs to wait for poet to complete in publish epoch. Once completed, node fetches proof from poet and runs post on that proof. After that publish an ATX that will be eligible for rewards in target epoch.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;poetWaitProof&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;publish&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;target&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wait&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;871416.313797373s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-08T08:00:01.432480745Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Computed eligibilities for the epoch. Rewards will be received after publishing proposals at specified layers. Total amount of rewards in SMH will be based on other participants in the layer.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;eligibilities&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;epoch&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;beacon&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nhiDhQ==&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;atx&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;...&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;activeSetSize&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16582</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;eligibilities&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16792</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-08T12:00:00.349079938Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Published proposal. Rewards will be received, once proposal is included into the block.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;proposal&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16176</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;proposal&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Retrieve account data including current balance, counter value, and rewards:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext -d </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{ </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">filter</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: { </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">account_id</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: { </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">address</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">&lt;address&gt;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)"> }, </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">account_data_flags</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: 6 } }&quot;</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1:9092 spacemesh.v1.GlobalStateService.AccountDataQuery</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;totalResults&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accountItem&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">8186</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;total&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10802055452&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layerReward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10802053003&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coinbase&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;address&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;address&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accountWrapper&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accountId&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;address&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;address&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;stateCurrent&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;counter&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;balance&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;190459923001&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;stateProjected&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;counter&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;balance&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;190459923001&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The Spacemesh node gRPC API lives in the <a href="https://github.com/spacemeshos/api/" target="_blank" rel="noopener noreferrer">api repository</a>; see the <a href="https://github.com/spacemeshos/api/tree/master/spacemesh/v1" target="_blank" rel="noopener noreferrer">service definitions</a>. The implementation lives in the <a href="https://github.com/spacemeshos/go-spacemesh/tree/develop/api/grpcserver" target="_blank" rel="noopener noreferrer"><code>api</code> directory</a> of the go-spacemesh repository.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updates">Updates<a href="#updates" class="hash-link" aria-label="Direct link to Updates" title="Direct link to Updates">​</a></h2><p>The Spacemesh team regularly releases updates to GUI and CLI node software. Smapp has a feature that monitors new releases and notifies the user when a new release is available, with a one-click update mechanism (Linux users who installed Smapp using the .deb file will need to manually check for and install updates due to <a href="https://github.com/spacemeshos/smapp/issues/1299" target="_blank" rel="noopener noreferrer">this issue</a>). Note that, at present, go-spacemesh updates are bundled into Smapp updates, though this may change in the future; and go-spacemesh and Smapp use independent version numbering (e.g., Smapp <a href="https://github.com/spacemeshos/smapp/releases/tag/v1.0.18" target="_blank" rel="noopener noreferrer">v1.0.18</a> bundles go-spacemesh v1.0.19).</p><p>No such notify or update mechanism is built into <code>go-spacemesh</code>, so CLI node operators will need to manually keep their software up to date. Node updates vary in severity and, while it&#x27;s generally safe to be one or two patch releases behind, this isn&#x27;t always the case and some bigger updates may need to be installed right away in order to keep one&#x27;s node online and mining, and in order not to receive rewards. Releases are announced on several channels including:</p><ul><li><a href="https://github.com/spacemeshos/go-spacemesh/releases" target="_blank" rel="noopener noreferrer">go-spacemesh releases</a> on GitHub</li><li>the <a href="https://discord.com/channels/623195163510046732/691258865861394432" target="_blank" rel="noopener noreferrer">#announcements channel</a> on the Spacemesh Discord</li><li>the official <a href="https://twitter.com/teamspacemesh" target="_blank" rel="noopener noreferrer">Spacemesh Twitter</a></li></ul><p>You are strongly encouraged to watch one or more of these channels closely and/or <a href="https://docs.github.com/en/account-and-profile/managing-subscriptions-and-notifications-on-github/setting-up-notifications/configuring-notifications#configuring-your-watch-settings-for-an-individual-repository" target="_blank" rel="noopener noreferrer">subscribe to GitHub release notifications</a> so that your node is up to date.</p><h1>PoST Initialization</h1><p>The hardest and most important part of becoming a smesher is the PoST initialization (sometimes referred to as &quot;plotting&quot;). This process requires a GPU and is designed to be costly and time-consuming due to the cryptoeconomic design of the protocol. As described above, unlike in proof of stake networks, there&#x27;s no &quot;slashing&quot; (burning a portion of stake) in the Spacemesh protocol. Instead, the sanction for engaging in malicious behavior such as equivocation is invalidation of a smesher ID, which invalidates all of the PoST data associated with that ID. In order for this sanction to be costly, performing PoST initialization and generating PoST data must also be costly.</p><p>Note that initialization can theoretically be performed using a CPU (as opposed to a GPU), but it will take so long that this option isn&#x27;t viable for the vast majority of miners.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opencl">OpenCL<a href="#opencl" class="hash-link" aria-label="Direct link to OpenCL" title="Direct link to OpenCL">​</a></h2><p>PoST initialization requires support for <a href="https://en.wikipedia.org/wiki/OpenCL" target="_blank" rel="noopener noreferrer">OpenCL</a>. Installation instructions will vary depending upon your operating system, platform, and GPU hardware. A good starting place for Linux users is <a href="https://wiki.archlinux.org/title/GPGPU" target="_blank" rel="noopener noreferrer">this wiki page</a>. On Ubuntu and other Debian-compatible systems it may be enough to install these packages:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> ocl-icd-libopencl1 opencl-headers clinfo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To test if OpenCL is installed and configured correctly on your system, try running <code>clinfo</code>. You should see output similar to the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> clinfo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Platform </span><span class="token comment" style="color:rgb(98, 114, 164)">#0: NVIDIA CUDA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> `-- Device </span><span class="token comment" style="color:rgb(98, 114, 164)">#0: NVIDIA GeForce RTX 2060 SUPER</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>macOS Overview</strong></p><p>For macOS users, OpenCL is bundled with the system, and the framework is available out of the box on macOS version 10.6 (Snow Leopard) and later. Therefore, explicit installation of OpenCL is generally not required. However, to ensure compatibility and optimal performance with your specific hardware and software setup, you might need to update your macOS.</p><p><strong>Steps</strong></p><ul><li>Update macOS: Keep your macOS up to date to ensure you have the latest OpenCL framework versions and GPU drivers. You can check for updates in the “Software Update” section of System Preferences.</li><li>Use clinfo: To verify the OpenCL configuration, you can install <code>clinfo</code> using the command <code>brew install clinfo</code>. Then, run <code>clinfo</code> in the terminal to check the available OpenCL platforms and devices.</li></ul><p><strong>Windows Installation Overview</strong></p><p>Installing OpenCL on Windows requires manual GPU drivers updates, as the operating system does not include these drivers by default. The process is similar across different GPU manufacturers but requires visiting the specific manufacturer’s website to download the appropriate drivers.</p><p><strong>Steps</strong></p><ul><li>Download Drivers: Navigate to your GPU manufacturer’s website (NVIDIA, AMD, or Intel).</li><li>Select your GPU model and download the latest drivers that include the OpenCL runtime support.</li><li>Install the Drivers: Execute the downloaded installer and follow the on-screen instructions to complete the installation. Make sure any options related to OpenCL support are selected if given a choice.</li><li>Verification</li><li>After installation, use the <code>clinfo</code> command on Windows to check for OpenCL support. This utility will list all OpenCL-compatible devices on your system and provide detailed information, confirming a successful installation.</li></ul><p><strong>Troubleshooting</strong></p><p>Issues with OpenCL can often be resolved by ensuring your GPU drivers are fully up to date. Check your hardware’s compatibility with the version of OpenCL you’re using and look for any software that might conflict with your drivers. For specific problems, the support documentation and forums for NVIDIA, AMD, or Intel may offer solutions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initialization-speed">Initialization Speed<a href="#initialization-speed" class="hash-link" aria-label="Direct link to Initialization Speed" title="Direct link to Initialization Speed">​</a></h2><p>The amount of time it takes to complete PoST initialization depends upon a number of factors including GPU model, hard drive write speed, and the number of storage units being initialized. As a rule of thumb, Nvidia RTX 3090 cards can initialize around 3-4 MB/s and 4090 cards can initialize around 6-7 MB/s. Community <a href="https://docs.google.com/spreadsheets/d/1X_E7H9EFdLoEZ8IHwm1ApcnlZ6VtBCWwSMOJIw2rytI/edit#gid=822058896" target="_blank" rel="noopener noreferrer">crowdsourced benchmarks</a> are available for a wide range of cards. Note that hard drive write speeds tend to be much faster than GPU throughput, so this shouldn&#x27;t limit the initialization speed unless the drive is exceptionally slow or exceptionally busy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="choice-of-filesystem">Choice of Filesystem<a href="#choice-of-filesystem" class="hash-link" aria-label="Direct link to Choice of Filesystem" title="Direct link to Choice of Filesystem">​</a></h2><p>In general Spacemesh is agnostic to the choice of filesystem. You can successfully initialize and run an identity and manage the underlying PoST data on any Linux, Windows, or macOS-compatible filesystem. However, you should keep two things in mind when choosing a filesystem.</p><ol><li><p>If there&#x27;s any chance you&#x27;ll want to move the identity from one operating system to another, we strongly recommend using the <a href="https://en.wikipedia.org/wiki/ExFAT" target="_blank" rel="noopener noreferrer">exFAT</a> filesystem. This is the only filesystem that works out of the box across all the major operating systems. Keep in mind that <em>copying</em> an entire identity from one filesystem to another could take a very long time, whereas with an exFAT filesystem you can just &quot;plug and chug&quot; on any computer. You should be able to initialize and format a new exFAT filesystem easily in any operating system.</p></li><li><p>Different filesystems utilize space differently and require different amounts of overhead. As such, the number of storage units you&#x27;ll be able to fit on a given disk will depend to some extent upon the filesystem used to format the disk. In my personal experience I&#x27;ve found that exFAT is more efficient than EXT4, and may allow one extra storage unit to be placed on the same physical disk.</p></li></ol><p>We also recommend that you <em>not encrypt</em> the drive or partition used to store the PoST data. You should of course protect the <code>key.bin</code> file (which contains a miner&#x27;s private key) and not allow it to fall into anyone else&#x27;s hands, but full drive encryption feels like overkill and could slow down <a href="#proof-generation">proof generation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="number-of-units">Number of Units<a href="#number-of-units" class="hash-link" aria-label="Direct link to Number of Units" title="Direct link to Number of Units">​</a></h2><p>Determining exactly how many storage units fit on a drive is actually somewhat non-trivial if you want to maximize the amount of PoST data you can fit on a drive, maximize the identity size, and maximize the rewards. For one thing, PoST identity file sizes are <a href="#units">base-2</a> (e.g., 64GiB) whereas the size of most hard drives is base-10 (e.g., 1TB). Moreover, as described in the previous section, different filesystems use space differently and require different amounts of overhead.</p><p>Linux users may find a command such as the following helpful in displaying the available space on a drive:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">df</span><span class="token plain"> -B GiB /dev/sda</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Filesystem     1GiB-blocks    Used Available Use% Mounted on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sda           3667GiB 3649GiB     19GiB </span><span class="token number">100</span><span class="token plain">% /mnt/smesher-01</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see, this 4TB drive, which should contain 3725.29 GiB, in fact only contains a usable 3667 GiB. After initializing 57 storage units of 64 GiB each, it contains around 19 GiB free usable space.</p><p>Linux users may also find the <a href="https://linux.die.net/man/8/tune2fs" target="_blank" rel="noopener noreferrer"><code>tune2fs</code></a> command useful, both for displaying more detailed filesystem information and for reducing the amount of <a href="https://unix.stackexchange.com/questions/7950/reserved-space-for-root-on-a-filesystem-why" target="_blank" rel="noopener noreferrer">reserved space</a> on a drive. Assuming a drive is exclusively being used to store PoST data, the reserved space may safely be set to zero. For example, for the above drive <code>/dev/sda</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> tune2fs -m </span><span class="token number">0</span><span class="token plain"> /dev/sda</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Wanted:</strong> Please fill in information on how to do the same on macOS and Windows.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="starting-initialization">Starting Initialization<a href="#starting-initialization" class="hash-link" aria-label="Direct link to Starting Initialization" title="Direct link to Starting Initialization">​</a></h2><p>As with most other aspects of Spacemesh, the easiest way to begin and monitor initialization is using the Smapp application. When you first open it, Smapp will walk you through the process of choosing a location for your PoST data, choosing your GPU, and beginning initialization. It&#x27;ll show you the progress as initialization proceeds. See <a href="https://youtu.be/xwsg7FzuBE0?si=UnTu4wF-db_O2jXE" target="_blank" rel="noopener noreferrer">Smapp Tutorial #4: Proof of Space &amp; Smeshing Setup</a> for more information on this process.</p><p>If you prefer to perform PoST initialization using the command line, you have two options. If you simply run <code>go-spacemesh</code> directly with the <code>smeshing</code> configuration parameters specified above, it&#x27;ll perform initialization for you using the fastest GPU. You can also manually perform initialization using the <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli" target="_blank" rel="noopener noreferrer"><code>postcli</code> tool</a>, which allows you to have even greater control of the initialization process, such as running in parallel across multiple systems or multiple GPUs (more information on this below).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="choosing-a-provider">Choosing a Provider<a href="#choosing-a-provider" class="hash-link" aria-label="Direct link to Choosing a Provider" title="Direct link to Choosing a Provider">​</a></h3><p>As mentioned, <code>go-spacemesh</code> will automatically choose the fastest GPU to perform initialization based on a benchmark. You can change the selected GPU with the <code>smeshing-opts-provider</code> config item. To see the list of detected GPUs and their corresponding indices, run <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli" target="_blank" rel="noopener noreferrer"><code>postcli</code></a> as follows. You should see something like the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> postcli -printProviders</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">postrs.Provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">len</span><span class="token operator">=</span><span class="token number">3</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">cap</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.Provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ID: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Model: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">len</span><span class="token operator">=</span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[GPU] NVIDIA CUDA/NVIDIA GeForce RTX 3080 Ti&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DeviceType: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.DeviceClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> GPU</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.Provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ID: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Model: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">len</span><span class="token operator">=</span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[GPU] NVIDIA CUDA/NVIDIA GeForce RTX 3080 Ti&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DeviceType: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.DeviceClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> GPU</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.Provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ID: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">4294967295</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Model: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">len</span><span class="token operator">=</span><span class="token number">17</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[CPU] scrypt-jane&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DeviceType: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">postrs.DeviceClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> CPU</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first two (with IDs 0 and 1) are the GPUs; the last (with ID 4294967295) is the CPU. To select the second GPU with ID 1, use the following config:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;smeshing&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;smeshing-opts&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;smeshing-opts-datadir&quot;: &quot;&lt;post_data_directory&gt;&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;smeshing-opts-maxfilesize&quot;: &lt;post_file_size&gt;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;smeshing-opts-numunits&quot;: &lt;post_num_units&gt;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;smeshing-opts-provider&quot;: 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>PoET</h1><p>As described above in <a href="#proof-of-elapsed-time">Proof of Elapsed Time</a>, the Spacemesh protocol depends for security not only upon committed <em>disk space</em> but also <em>elapsed time</em> (the time dimension in proofs of spacetime). For the time component, miners rely on a third-party service called a PoET (&quot;proof of elapsed time&quot;) server.</p><p>Note: Anyone can run their own PoET server, but this is non-trivial, expensive, and requires specialized hardware and devops. More importantly, a single PoET server can serve proofs to thousands of miners. Since the PoET server performs intensive, expensive computation on behalf of the miners it serves, and since a miner only needs a single PoET proof for a given epoch, it&#x27;s more efficient and less energy intensive to run a small number of PoET servers rather than having each miner run their own.</p><p>In general miners don&#x27;t need to think very much about PoET servers. The node (whether running Smapp or <code>go-spacemesh</code> directly) manages the process of discovering PoET servers, registering with them, and retrieving proofs when they&#x27;re ready. The node is also intelligent enough to register with many PoET servers redundantly so that if one server goes offline, it&#x27;ll still be able to retrieve a proof from another PoET server.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ticks-and-weight">Ticks and Weight<a href="#ticks-and-weight" class="hash-link" aria-label="Direct link to Ticks and Weight" title="Direct link to Ticks and Weight">​</a></h2><p>Miners establish eligibility to submit proposals and thus earn rewards by bundling their proofs of spacetime into a data structure known as an ATX. As also <a href="#atxs-and-weight">described above</a>, each ATX has a certain <strong>weight</strong> which is simply calculated as the number of storage units proven multiplied by the tick count from the PoET proof (as a proxy for time). Rewards earned by a miner in a given epoch are ultimately proportional to the weight of their ATX targeting that epoch. Thus, if a miner uses a PoET proof with fewer ticks, it&#x27;ll earn proportionally fewer rewards for at least the duration of one epoch; the reverse is also true.</p><p>Note that, in addition to retrieving proofs from multiple PoET servers, the node is also intelligent enough to use the proof with the highest tick count to ensure that it maximizes its rewards.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="timing">Timing<a href="#timing" class="hash-link" aria-label="Direct link to Timing" title="Direct link to Timing">​</a></h2><p>The Spacemesh team currently operates several production PoET servers for public use. (Their addresses are hardcoded into the <code>poet-server</code> section of the <a href="#config">mainnet config file</a>):</p><p>These PoET servers all operate on exactly the same schedule. In order to establish eligibility for epoch N, a miner must register with a PoET round in epoch N-2, then retrieve the PoET proof, use it to generate a PoST proof, bundle this into an ATX, and submit it to the network prior to the end of epoch N-1. The Spacemesh PoET servers start a new round at 8:00 UTC the second Monday of an epoch, i.e., four days prior to the end of the epoch. This round concludes 13.5 days later, at 20:00 UTC on Sunday. There&#x27;s subsequently a 12 hour &quot;cycle gap&quot; during which no PoET round is running, after which the next PoET round kicks off and the cycle repeats itself. During this 12 hour window, all mining nodes must retrieve their PoET proof from a PoET server, use it to generate a PoST proof, bundle this into an ATX, broadcast the ATX to the network, and then register with the PoET again in order to maintain continuous eligibility.</p><p>This schedule is admittedly confusing; you may find <a href="https://calendar.google.com/calendar/u/0/embed?src=8895d862c4a9ac22c8da2dafd9c618cd47e5c2d22905f920b1231a3b02aacd62@group.calendar.google.com" target="_blank" rel="noopener noreferrer">this unofficial calendar</a> and the header graphic in <a href="https://spacemesh.io/blog/genesis-timeline/" target="_blank" rel="noopener noreferrer">this blog post</a> helpful in visualizing it. To reiterate, in most cases miners don&#x27;t need to concern themselves with the PoET schedule since their node will handle everything for them. The most important thing is that the node remain running and online throughout the epoch so that PoET windows aren&#x27;t missed and continuous eligibility is maintained.</p><p>Note that in future it&#x27;s likely that, rather than all PoET servers running in identical phase, there will be PoET servers running in different phases, possibly also with different cycle gap lengths, to accommodate miners that need more time to generate a PoST proof or that simply miss a PoET registration window.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-a-poet-server">Running a PoET Server<a href="#running-a-poet-server" class="hash-link" aria-label="Direct link to Running a PoET Server" title="Direct link to Running a PoET Server">​</a></h2><p>As with the rest of Spacemesh infrastructure, the PoET server is <a href="https://github.com/spacemeshos/poet" target="_blank" rel="noopener noreferrer">open source</a> and permissionless. Anyone may run their own PoET server for personal or community use.</p><p>For more information see the <a href="https://github.com/spacemeshos/poet/blob/develop/docs/poet_operator_manual.md" target="_blank" rel="noopener noreferrer">PoET Operator Manual</a> and feel free to ask questions on the <a href="https://discord.com/channels/623195163510046732/1151165793590050867" target="_blank" rel="noopener noreferrer">#poet channel</a> on Discord.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updating-the-configuration-of-a-node-to-use-different-poets">Updating the configuration of a node to use different PoETs<a href="#updating-the-configuration-of-a-node-to-use-different-poets" class="hash-link" aria-label="Direct link to Updating the configuration of a node to use different PoETs" title="Direct link to Updating the configuration of a node to use different PoETs">​</a></h2><p>Spacemesh users are free to use any PoET they want to. You can add PoETs to the existing list of your nodes configuration or even completely replace it with another set of PoETs.</p><p>Adding a PoET with the same phase as the node is currently using simple; stop the node, update the configuration by adding the new PoET to the list of existing PoETs (and remove any you wish not to use), then start the node again. When the next PoET round starts the node will start using the new set PoET as given by its configuration.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="switching-phase">Switching phase<a href="#switching-phase" class="hash-link" aria-label="Direct link to Switching phase" title="Direct link to Switching phase">​</a></h3><p>If you wish to switch to one or multiple PoETs that operate on a different phase then the default set of PoETs ensure
that your node and the PoET(s) you are using have the following configuration parameters set to the same values:</p><ul><li><code>&quot;phase-shift&quot;</code>: gives the time that a new PoET round starts relative to the beginning of an epoch. For the default
set of PoETs this value is 240 hours. Lower values mean that nodes starting to use your PoET have to wait longer before
they become eligible to collect rewards, higher values mean that nodes have less time after fetching a PoET proof to
publish their ATX to be eligible to collect rewards.</li><li><code>&quot;cycle-gap&quot;</code>: gives the time between the end of a PoET round and the start of a new one. Larger values give nodes
more time to generate a PoST proof - since this has to happen within the cycle gap to not miss an epoch. Smaller values
gives the PoET more time to generate its proof and collect more ticks. For the default set of PoETs this value is
12 hours.</li></ul><p>Additionally you should ensure that a custom PoET has the same <code>&quot;genesis-time&quot;</code> and <code>&quot;epoch-duration&quot;</code> as mainnet
(<code>&quot;2023-07-14T08:00:00Z&quot;</code> and 336 hours respectively).</p><p>For a step by step instruction see <a href="#timing-a-phase-switch">Timing a phase switch</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="timing-a-phase-switch">Timing a phase switch<a href="#timing-a-phase-switch" class="hash-link" aria-label="Direct link to Timing a phase switch" title="Direct link to Timing a phase switch">​</a></h3><p>Switching phase bears the risk of missing a PoET round and thereby forfeiting your eligibility to collect rewards in an
upcoming epoch. To mitigate this risk you should time your phase switch and follow these steps:</p><ol><li><p>Wait until the end of the PoET round of the phase you are currently using.
If you are using the default PoETs this would be every second Sunday (e.g. Feb 5th, 2024) at 20:00 UTC.</p></li><li><p>Your node will fetch the PoET proof(s) for all PoETs it successfully registered for.</p></li><li><p>Wait until your node has finished generating a PoST proof and published an ATX (check logs for <code>ATX published</code>).</p></li><li><p>Stop the node.</p></li><li><p>Update your node configuration by replacing the PoET(s) in your <code>config.json</code> with the new one(s).
Make sure that all PoETs you are using have the same phase and cycle gap and that you also update the
<code>&quot;phase-shift&quot;</code> and <code>&quot;cycle-gap&quot;</code> settings in your config accordingly.</p></li><li><p>If you do not have sqlite installed on your system, install it now.
On Windows you can download it from <a href="https://www.sqlite.org/download.html" target="_blank" rel="noopener noreferrer">here</a>, you will need <code>sqlite-tools-win-x64</code>.
On Ubuntu you can install it with <code>sudo apt install sqlite3</code>.
On macOS you can install it via Homebrew with <code>brew install sqlite3</code>.</p></li><li><p>Delete the contents of the tables <code>poet_registration</code> and <code>nipost</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> sqlite3 </span><span class="token operator">&lt;</span><span class="token plain">node_config_directory</span><span class="token operator">&gt;</span><span class="token plain">/node_state.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sqlite</span><span class="token operator">&gt;</span><span class="token plain"> delete from poet_registration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sqlite</span><span class="token operator">&gt;</span><span class="token plain"> delete from nipost</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sqlite</span><span class="token operator">&gt;</span><span class="token plain"> .quit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Start the node again.</p></li></ol><p>If the new phase has not started yet your node will register at the new PoET(s) immediately and fetch a PoET proof in
time to be eligible to collect rewards in the next epoch. If by the time you restarted your node the new phase has already
started your node will register at the new PoET(s) in the next epoch and you will miss one epoch of rewards (the second
next epoch).</p><p><strong><em>Note</em></strong>: Before v1.3.x PoET registration state was stored in a file called <code>nipost_challenge.bin</code> and <code>nipost_builder_state.bin</code>
in the node&#x27;s PoST data directory. If you are using a node version older than v1.3.x you will have to delete these files
instead of the sqlite tables (steps 6 and 7).</p><h1>Proof Generation</h1><p>Once an epoch, after the node has received a PoET proof and during the PoET cycle gap, the node will generate a <a href="#proofs-of-spacetime">proof of spacetime</a>, which requires that it sequentially read all of the PoST data. The details aren&#x27;t something most miners need to worry about as the node will handle the process for you; see <a href="#fine-tuning-proving">Fine-tuning Proving</a> for information on benchmarks and parameters that can be tweaked.</p><p>The first part of the proving process is an initial proof of work phase called <strong>k2pow</strong> that uses a proof of work algorithm called <a href="https://github.com/tevador/RandomX" target="_blank" rel="noopener noreferrer">RandomX</a>. During this phase, which is CPU bound, you should see CPU usage spike briefly for a few minutes. There should be very little network or disk activity during this phase. As explained in the <a href="https://github.com/spacemeshos/post-rs/blob/main/docs/profiler.md#is-that-all-that-is-happening-during-the-proof-generation" target="_blank" rel="noopener noreferrer">Profiler docs</a>, it should take a low-end CPU around 2.5 minutes to compute k2pow for 4 SU; computation time scales linearly with the hash rate and number of storage units being proven. See the <a href="https://xmrig.com/benchmark" target="_blank" rel="noopener noreferrer">RandomX Benchmark</a> to get a sense of your CPU&#x27;s RandomX hash rate.</p><p>Once the k2pow phase is complete, the node begins the PoST proving process, which takes longer as it involves reading and computing a hash function over all the committed PoST data. How long depends on factors including the disk read speed, CPU speed, and configured <a href="#fine-tuning-proving">nonces and threads</a>. This process may be CPU bound or IO bound, depending on the configuration. (It also doesn&#x27;t touch the network.)</p><p>Another way to tell that the PoST proving process is underway or complete is to look for files called <code>post.bin</code>, <code>nipost_challenge.bin</code> and <code>nipost_builder_state.bin</code> in the PoST data directory. <strong>TODO:</strong> add more information on these files and their roles, and the point during the process where they&#x27;re created.</p><h1>Rewards</h1><p>In Spacemesh, miners earn rewards for successfully proving eligibility and submitting valid block proposals to the network in their designated eligibility slots. Note that, at present, the only behavior that&#x27;s rewarded is submission of block proposals, but in the future we intend to additionally incentivize other useful behavior such as participating in Hare consensus.</p><p>As with many other blockchain networks, rewards consist of two components: block subsidy, i.e., coins newly minted by the protocol; and transaction fees. While we expect transaction fees to increase and form a larger percentage of rewards over time, at this early stage in the network lifecycle the vast majority of rewards (more than 99.99%) derive from block subsidies. As such the remainder of this analysis will ignore transaction fees for the purpose of estimating rewards.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="estimated-rewards">Estimated Rewards<a href="#estimated-rewards" class="hash-link" aria-label="Direct link to Estimated Rewards" title="Direct link to Estimated Rewards">​</a></h2><p>Three factors are necessary to calculate a miner&#x27;s estimated rewards: the miner&#x27;s <strong>weight</strong> in a given epoch, the <strong>total network weight</strong> in the epoch, and the <strong>per-layer subsidy.</strong></p><p>As described above, a miner&#x27;s weight in a given epoch (as encoded in the ATX they submitted to establish eligibility for the epoch) is simply the number of storage units proven times the number of PoET ticks. For instance, a miner with 4 SU (the minimum) and a PoET proof with 100k ticks would have a weight of 400k.</p><p>The total network weight is (as the name suggests) the weight of <em>all</em> eligible miners in the same epoch. A miner&#x27;s <strong>relative weight</strong> is the weight of their ATX in a given epoch divided by the total network weight in that epoch. There isn&#x27;t currently an easy way to retrieve total network weight but, given that at present nearly all miners are using the same PoET proof or a PoET proof with a similar number of ticks, it can be estimated by dividing the miner&#x27;s total committed storage by the total network storage (as displayed on the <a href="https://dash.spacemesh.io/" target="_blank" rel="noopener noreferrer">Network Dashboard</a>). For instance, a miner with 1TiB of storage of a network that&#x27;s 18PiB has 1/18000 = 5.6e-5 of the total network space.</p><p>The final piece of the puzzle is the per-layer reward. This decays gradually from layer to layer. The simplest way to see the current value is to check <a href="https://explorer.spacemesh.io/layers" target="_blank" rel="noopener noreferrer">LAYERS</a> in the Explorer. As of <a href="https://explorer.spacemesh.io/layers/17980" target="_blank" rel="noopener noreferrer">layer 17980</a>, 476.614 SMH are being minted as a subsidy each layer. Multiply this by the number of layers per epoch, 4032, to get the approximate total new issuance per epoch: for epoch 4 this is roughly 4032 * 476.614 = 1,921,707 SMH.</p><p>Finally, to calculate a miner&#x27;s estimated rewards for a given epoch simply multiply its relative weight by the total epoch issuance. A miner with 5.6e-5 of the total weight would be expected to earn around 5.6e-5*1921707 = 107 SMH in this epoch.</p><p>Note: It is possible to read more precise values from a node&#x27;s state database (see below). This sample SQL query will give you the total weight for an epoch:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">SUM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">effective_num_units</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">*</span><span class="token function" style="color:rgb(80, 250, 123)">SUM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tick_count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> atxs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> epoch</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">3091782534750</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And this query will give an individual miner&#x27;s relative weight:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token operator">*</span><span class="token plain">atxs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">effective_num_units</span><span class="token operator">*</span><span class="token plain">atxs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tick_count</span><span class="token operator">/</span><span class="token plain">total_weight</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">weight</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> atxs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">SUM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">effective_num_units</span><span class="token operator">*</span><span class="token plain">tick_count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> weight </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> atxs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> epoch</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> total_weight</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">atxs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1281641D519CCC57F38C38294BB873A60367DB71AD0FA8DFBD146A55FD60626C&quot;</span><span class="token plain"> </span><span class="token operator">AND</span><span class="token plain"> atxs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">epoch</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">0.000519591429387197</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Some miners may find community-run tools like <a href="https://www.spacemeshcalculator.com/" target="_blank" rel="noopener noreferrer">Spacemesh Calculator</a> helpful in doing this math, but we cannot vouch for their correctness.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="eligibility-slots">Eligibility Slots<a href="#eligibility-slots" class="hash-link" aria-label="Direct link to Eligibility Slots" title="Direct link to Eligibility Slots">​</a></h2><p>Every eligible miner has one or more slots per epoch where they&#x27;re eligible to produce a proposal (and thus earn a reward). Every miner with at least the minimum storage (4 storage units) is guaranteed at least one slot per epoch. There are 50 slots per layer (i.e., on average 50 proposals per layer) or 201,600 slots per epoch. The slots are assigned randomly and unpredictably at the start of the epoch so that even the miner itself doesn&#x27;t know its own eligibility slots before the epoch starts. You can calculate the estimated number of slots for a given miner using similar math to the above: multiply the miner&#x27;s relative epoch weight by 201,600 with floor=1.</p><p>There are several ways to see a miner&#x27;s actual eligibility slots for a given epoch. The node prints its eligibilities in the log at the beginning of an epoch, e.g.:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2023-08-11T13:45:00.622-0400    INFO    abcde.proposalBuilder   proposal eligibility for an epoch       {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;proposalBuilder&quot;, &quot;epoch_id&quot;: 2, &quot;beacon&quot;: &quot;e3e3389e&quot;, &quot;weight&quot;: 141435, &quot;min activeset weight&quot;: 5000000, &quot;total weight&quot;: 305096691, &quot;total num slots&quot;: 93, &quot;num layers eligible&quot;: 93, &quot;layers to num proposals&quot;: [{&quot;layer&quot;: 8091, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8179, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8212, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8215, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8248, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8306, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8382, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8389, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8411, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8432, &quot;slots&quot;: 1}, {&quot;layer&quot;: 8454, &quot;slots&quot;: 1}...], &quot;name&quot;: &quot;proposalBuilder&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>EventsStream</code> API stream prints the same information:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -d </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{}&quot;</span><span class="token plain"> -plaintext localhost:9093 spacemesh.v1.AdminService.EventsStream</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-13T19:35:00.658169226Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Computed eligibilities for the epoch. Rewards will be received after publishing proposals at specified layers. Total amount of rewards in SMH will be based on other participants in the layer.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;eligibilities&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;epoch&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;beacon&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nhiDhQ==&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;atx&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;activeSetSize&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">16582</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;eligibilities&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">19048</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">19460</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">18839</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In Smapp the same thing looks like this:</p><p><img loading="lazy" src="https://github.com/spacemeshos/wiki/assets/3316532/be77ccd8-ab5f-4763-8a98-8c37f606241e" alt="image" class="img_ev3q"></p><p>In order to successfully earn a reward for a given eligibility slot, a miner has to be running up to date software, has to be online and fully synced, and has to successfully generate and broadcast a proposal during the slot. The actual, final reward that&#x27;s earned in a given slot depends upon the behavior of other eligible miners in the same slot. If an eligible miner fails to submit a proposal, that miner&#x27;s portion of the reward is distributed to the eligible miners that successfully publish proposals.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="earned-rewards">Earned Rewards<a href="#earned-rewards" class="hash-link" aria-label="Direct link to Earned Rewards" title="Direct link to Earned Rewards">​</a></h2><p>Smapp displays actual earned rewards on the SMESHING screen:</p><p><img loading="lazy" src="https://github.com/spacemeshos/wiki/assets/3316532/fb1ce5fa-fac5-4f36-9ef8-e22988487ce4" alt="image" class="img_ev3q"></p><p>They&#x27;re also available <a href="https://explorer.spacemesh.io/accounts/sm1qqqqqqzgxd05fhulhhtqyl2s8tqsmg4wvhyvwagag395g/rewards" target="_blank" rel="noopener noreferrer">in the explorer</a>. Finally, actual rewards for a given coinbase address can also be read from the command line using the API:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> grpcurl -plaintext -d </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{ </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">filter</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: { </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">account_id</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: { </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">address</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">sm1qqqqqqzgxd05fhulhhtqyl2s8tqsmg4wvhyvwagag395g</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)"> }, </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">account_data_flags</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: 2 } }&quot;</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1:9092 spacemesh.v1.GlobalStateService.AccountDataQuery</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;totalResults&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">128</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accountItem&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">8203</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;total&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17127640416&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layerReward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;17127640416&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coinbase&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;address&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sm1qqqqqqzgxd05fhulhhtqyl2s8tqsmg4wvhyvwagag395g&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layer&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;number&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">8219</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;total&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;14085313144&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;layerReward&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;value&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;14085307220&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coinbase&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;address&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sm1qqqqqqzgxd05fhulhhtqyl2s8tqsmg4wvhyvwagag395g&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You may also find this community-run <a href="http://fcmx.net/sm-eligibilities/" target="_blank" rel="noopener noreferrer">SpaceMesh Lamba Chunks</a> visual reward tracker useful. You copy your eligibility info from your logfile (grep for &quot;proposal eligibility for an epoch&quot; in your log) and paste it into a Node to see a visual representation of all past eligibilities and rewards, and upcoming eligibility slots. It should look something like this:</p><p><img loading="lazy" src="https://github.com/spacemeshos/wiki/assets/3316532/3dd5d040-f65c-46ba-9b8a-d35756f10244" alt="image" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="missed-rewards">Missed Rewards<a href="#missed-rewards" class="hash-link" aria-label="Direct link to Missed Rewards" title="Direct link to Missed Rewards">​</a></h2><p>If your node is offline or not fully synced when an eligible slot arrives, it may fail to produce a proposal and thus miss a reward for the slot. If a proposal is produced or gossiped too late, or not received by enough other nodes in time, it may also not be included in the canonical block and thus the slot reward may be missed. Note that this has no bearing whatsoever upon future eligibilities, and note also that the protocol does not allow a miner to subsequently &quot;earn back&quot; lost rewards. In this scenario, the coins that the miner would&#x27;ve received will instead be allocated proportionally (i.e., by weight) to the other eligible miners that successfully produced proposals in the same slot. By far the most common cause of missed rewards is node updates. We strongly encourage you to closely track your node eligibilities and not restart or upgrade within 2-3 layers before an upcoming eligibility (so that the node has a chance to fully initialize and sync in time).</p><p>There are also rare scenarios when no proposals are produced at all for a given layer, e.g., when the <a href="#hare">Hare</a> fails due to a network issue such as many miners temporarily being offline. In these scenarios, which are usually short-lived, no proposals are produced at all, a layer will have no block and no transactions, and no rewards will be issued. In this case, the coins that would&#x27;ve been issued as part of the layer subsidy simply fail to get minted, i.e., they will never exist, will never enter circulation, and for all intents and purposes may be considered burnt.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reward-lifecycle">Reward Lifecycle<a href="#reward-lifecycle" class="hash-link" aria-label="Direct link to Reward Lifecycle" title="Direct link to Reward Lifecycle">​</a></h2><p>The end to end reward lifecycle works as follows:</p><ol><li>Mining node performs <a href="#post-initialization-2">PoST initialization</a></li><li>Mining node generates its initial <a href="#proof-generation">proof of spacetime</a></li><li>Mining node registers with the <a href="#poet">PoET</a></li><li>Mining node receives proof from PoET server and uses it to generate another proof of spacetime (proving that it still has the data)</li><li>Mining node bundles this proof into an ATX and submits it to the network to establish eligibility in the following epoch</li><li>The new epoch begins. The mining node calculates its eligibilities for the new epoch (based on active set and random beacon).</li><li>Mining node participates in gossip normally and follows the network, remaining in sync, periodically joining a Hare committee, etc.</li><li>When an eligibility slot (layer) arrives, the miner generates a block proposal based on its view of the network (which valid transactions it&#x27;s collected into its mempool, signs it, and broadcasts it to the rest of the network</li><li>A few seconds later the <a href="#hare">Hare protocol</a> runs for the layer. A random committee of nodes is picked to come to consensus on the canonical set of valid proposals for the layer (i.e., those received on time and with valid eligibility proofs) and they&#x27;re collated into a new block. Assuming the mining node&#x27;s proposal is valid and it was received on time, it should be included in the new block.</li><li>A few minutes later the new block is confirmed by the <a href="#tortoise">Tortoise</a> and its contents become a part of the canonical mesh. Rewards are paid to all miners that participated in the construction of the block by submitting valid, on time proposals.</li></ol><p>Note that this describes the happy flow. Many things can happen to interfere with this process or slow it down. Proposals may not be gossiped or received on time, in which case a block still be created from the valid proposals that were received on time. If not enough nodes are online to select a Hare committee, Hare may fail, which would temporarily result in empty layers (i.e., layers without blocks), until nodes come back online and a Hare quorum can be re-established.</p><p>See also <a href="#rewards">Rewards</a>, above.</p><h1>Advanced Topics</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">​</a></h2><p>The simplest and most straightforward way to monitor any running node, including a mining node, is using the <a href="#api">gRPC API</a>. You can use the <code>spacemesh.v1.NodeService.Status</code> to see the current status (number of connected peers, sync status, layer status), and you can use the <code>spacemesh.v1.AdminService.EventsStream</code> to follow events (such as proof creation and broadcast, eligibilities, etc.) (see <a href="#api">API</a> for example commands).</p><p>It&#x27;s also possible to do more sophisticated monitoring using <a href="https://prometheus.io/docs/visualization/grafana/" target="_blank" rel="noopener noreferrer">Prometheus and Grafana</a>. You can configure your own Prometheus data model, or use the out of the box model that <code>go-spacemesh</code> already supports. If you run the node with the <code>--metrics</code> flag (or set this in the <a href="#config">config</a>), and optionally <code>--metrics-port</code>, then Prometheus can scrape metrics from the running node.</p><p>You can find community-contributed examples of both of these in <a href="https://github.com/lrettig/awesome-spacemesh/blob/main/README.md#monitoring" target="_blank" rel="noopener noreferrer">this list</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="increasing-and-decreasing-storage">Increasing and Decreasing Storage<a href="#increasing-and-decreasing-storage" class="hash-link" aria-label="Direct link to Increasing and Decreasing Storage" title="Direct link to Increasing and Decreasing Storage">​</a></h2><p>Eventually Spacemesh will allow miners to both increase and decrease their committed storage, i.e., their identity size, as well as to combine existing identities. Unfortunately these features have not yet been implemented. You may track progress <a href="https://github.com/spacemeshos/pm/issues/253" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://github.com/spacemeshos/pm/issues/267" target="_blank" rel="noopener noreferrer">here</a>.</p><p>In the meantime it&#x27;s only possible for a miner to change their committed storage <em>before</em> they&#x27;ve committed to the storage, i.e., before they&#x27;ve <a href="#proof-generation">generated a proof</a>, bundled it into an ATX and submitted it to the network. Changing the identity size is as simple as changing the number of units (<code>smeshing-opts-numunits</code> in the <a href="#config">config</a>); if you decrease this value and then run the node, <strong>it will erase the redundant files beyond the specified number of units</strong>, so be very careful. If you increase this value and then run the node, it will continue to initialize until the specified number of units has been initialized.</p><p>If you&#x27;re not sure whether your node has already submitted an ATX, check your event log for a message such as the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2023-09-18T01:55:32.528857736Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;help&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Published activation for the current epoch. Node needs to wait till the start of the target epoch in order to be eligible for rewards.&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;atxPublished&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;current&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;target&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abcde&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wait&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;367467.471143316s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see the following in the node log:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">spacemesh-log.txt:2023-09-17T17:44:08.967-0400     INFO    c6322.atxBuilder        atx published   {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;atxBuilder&quot;, &quot;sessionId&quot;: &quot;3917e715-39c0-4a4d-8b65-1d5c45df4b5f&quot;, &quot;event&quot;: true, &quot;atx_id&quot;: &quot;abcde&quot;, &quot;challenge&quot;: &quot;abcde&quot;, &quot;smesher&quot;: &quot;abcde&quot;, &quot;prev_atx_id&quot;: &quot;abcde&quot;, &quot;pos_atx_id&quot;: &quot;a1ba824af9&quot;, &quot;coinbase&quot;: &quot;sm1q...abcde&quot;, &quot;epoch&quot;: 4, &quot;num_units&quot;: 4, &quot;sequence_number&quot;: 3, &quot;size&quot;: 902, &quot;name&quot;: &quot;atxBuilder&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you suspect that your node has already submitted an ATX to commit to a specific number of units, don&#x27;t attempt to change the number of storage units as this will result in invalid proofs and zero rewards. If you&#x27;re certain that your node has not yet submitted an ATX to commit to its storage size, you can freely change the number of units.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="very-large-identities">Very Large Identities<a href="#very-large-identities" class="hash-link" aria-label="Direct link to Very Large Identities" title="Direct link to Very Large Identities">​</a></h2><p>In general a miner is free to initialize as much or as little storage as she likes. However, miners with especially large identities may run into problems with <a href="#proof-generation">PoST proof generation</a> as this requires sequentially reading all of the PoST data and additionally doing proof of work over the data. In the worst case, if the user selects a relatively low number of nonces (see next section), the node may get unlucky and need to perform this sequential read multiple times. All of this needs to fit into the PoET <a href="#timing">cycle gap</a> (12 hours for mainnet) or else the miner risks being ineligible for an entire epoch and missing all epoch rewards.</p><p>Precisely calculating the maximum identity size that a system can support depends upon a number of variables: drive read speed, CPU power, the other applications running on the system, and the configured parameters (see next section). As a rule of thumb, we recommend that miners not use identities larger than about 4 TiB (i.e., 64 storage units). Given the average hard drive read speed, and assuming the miner is running on a reasonably powerful system, a miner with a 4 TiB identity should have ample time to read that identity twice, if necessary, and successfully generate a proof during the cycle gap in the vast majority of cases. It should also be noted that advanced miners have reported achieving significantly higher throughput speeds and, thus, being able to manage much larger identities using, e.g., large NVMe SSD drives and/or <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_5" target="_blank" rel="noopener noreferrer">RAID5</a> configurations.</p><p>For very large identities, it probably makes sense to split the identity into multiple smaller identities (again, 4 TiB is a good starting point, although the exact amount will depend upon the system and the miner&#x27;s needs). Assuming these identities are stored on physically separate disks, and assuming the miner has a system that&#x27;s powerful enough to run multiple nodes (i.e., the system resources are a multiple of the <a href="#requirements">required resources</a> for a single node), she should have no trouble running multiple identities on a single system.</p><p>You may find math such as the following helpful: assuming you know the throughput (based on drive read speed and CPU hash throughput), it should take <a href="https://www.wolframalpha.com/input?i=4TiB%2F%5B150MB%2Fsec%5D" target="_blank" rel="noopener noreferrer">a little over eight hours</a> to create a proof serially for a single 4TiB identity assuming a throughput of 150MB/s (normal for a modern HDD). Note that in this case, if the number of nonces isn&#x27;t high enough (see next section) and the proof generation fails in the first pass, there won&#x27;t be enough time to perform a second pass during the 12 hour cycle gap!</p><p>Such a miner should pay close attention to the contents of the <a href="#fine-tuning-proving">Fine-tuning Proving</a> and <a href="#identity-management">Identity Management</a> sections, as she&#x27;ll need to generate and manage multiple identities, being sure to keep them separate and distinct and to <a href="#avoiding-equivocation">avoid equivocation</a>, and also to pick the appropriate proving parameters for her setup.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fine-tuning-proving">Fine-tuning Proving<a href="#fine-tuning-proving" class="hash-link" aria-label="Direct link to Fine-tuning Proving" title="Direct link to Fine-tuning Proving">​</a></h2><p>As a refresher, there are two stages to the process of proving storage so that a miner will be eligible for rewards on an ongoing basis: the <a href="#post-initialization-2">PoST initialization</a>, which only needs to be performed once, and the ongoing, regular <a href="#proofs-of-spacetime">proofs of spacetime</a> that miners need to generate and broadcast each epoch. Generating a proof of spacetime requires that the miner perform a sequential read of all of their PoST data. Since it would be infeasible to transmit <em>all</em> of the PoST data as a proof, in order to make the proofs succinct, Spacemesh instead requires miners to do a small proof of work each epoch by hashing their PoST data and looking for elements (known as <strong>labels</strong>) that pass a certain proof of work threshold. The proof itself consists of just the indices of the labels that pass the threshold.</p><p>The user may specify the number of CPU threads and nonces that are used in the proving process. The process itself is probabilistic: with 64 nonces the probability of creating a successful proof in a single pass is 79.39%; with 128 nonces it&#x27;s 95.75%; and with 288 nonces it&#x27;s 99.9%. Moreover the number of CPU threads must be set to balance disk read speed. For more information on this process, see <a href="https://community.spacemesh.io/t/proof-of-work-and-post-proof-generation/361" target="_blank" rel="noopener noreferrer">Proof of work and PoST proof generation</a> in the Spacemesh research forum.</p><p>As described in the <a href="#config">Config</a> section above, these parameters can be passed to <code>postcli</code> (as command-line arguments) and <code>go-spacemesh</code> (command-line arguments or via the config file). Advanced miners will need to run some benchmarks to determine the best values for their particular system. See the documentation for <a href="https://github.com/spacemeshos/post-rs/blob/main/docs/profiler.md" target="_blank" rel="noopener noreferrer">the profiler tool</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="identity-management">Identity Management<a href="#identity-management" class="hash-link" aria-label="Direct link to Identity Management" title="Direct link to Identity Management">​</a></h2><p>Each miner in Spacemesh has an identity, known as a miner ID or smesher ID. The ID is simply a 32-byte Ed25519 public key, which is commonly displayed in hexidecimal or base64 format. It should look something like <code>0x91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</code> (hex) or <code>kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=</code> (base64).</p><p>Note: Miner identities have absolutely nothing to do with accounts or wallet addresses. Both are based on Ed25519 keypairs, but that&#x27;s all they have in common. A miner also needs to specify a coinbase account to receive its rewards, but that coinbase account is not derived from the miner identity nor connected to it in any way. It can also be changed at any time. The miner identity <strong>is connected</strong> to its PoST data, however. PoST data generated for a given miner ID can never be used by another miner. Moreover, if a miner identity is lost or invalidated for equivocation, the associated PoST data becomes useless.</p><p>Tip: You can convert between these two formats using two simple command-line tools:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xxd -r -p </span><span class="token operator">|</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> base64 -d </span><span class="token operator">|</span><span class="token plain"> xxd -p -c </span><span class="token number">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first time the node runs it will create a new miner identity (if it doesn&#x27;t see an existing one), which it stores in a file called <code>key.bin</code> in the PoST data directory. This file contains both the miner public and private keys. The private key is used to sign messages on behalf of the miner. It&#x27;s critical both that this file be kept private (its contents should never be revealed or sent to anyone) and that it not be lost. If it&#x27;s lost, just like a lost wallet there&#x27;s absolutely no way to restore it, and the associated PoST data would become useless.</p><p>You can read the public key portion of the key file, i.e., the hexidecimal miner identity, as follows:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cut</span><span class="token plain"> -c </span><span class="token number">65</span><span class="token plain">-128 key.bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">91b8db4fecd9cd5db953275fdefb0b8cdfb08954e9186d9dc6f86b2a81980d40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also read the identity from a running node via the API:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; grpcurl -plaintext localhost:9093 spacemesh.v1.SmesherService.SmesherID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;publicKey&quot;: &quot;kbjbT+zZzV25Uydf3vsLjN+wiVTpGG2dxvhrKoGYDUA=&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A miner identity can be transferred from one system to another simply by moving the <code>key.bin</code> file. However, it&#x27;s essential that the same identity never be attached to two running miners at the same time in order to avoid equivocation (see next section).</p><p>A new identity can be generated by deleting or moving the <code>key.bin</code> file and starting the node again, at which point a new identity will be created. <code>postcli</code> can be used to do the same thing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="moving-post-files">Moving PoST files<a href="#moving-post-files" class="hash-link" aria-label="Direct link to Moving PoST files" title="Direct link to Moving PoST files">​</a></h2><p>You can safely move PoST data from one directory to another, or from one system to another, as long as the data remain intact and you&#x27;re careful to avoid equivocation (see next point). The miner identity used to create the PoST data is bound into the data and, thus, you must move the <code>key.bin</code> file along with the rest of the data; the data are useless without the <code>key.bin</code> identity file, and any attempt to use the same PoST data with a different miner identity will fail. There&#x27;s nothing about the data that ties it to a particular system, architecture, or operating system; thus, it&#x27;s also safe to move the data across systems.</p><p>We strongly recommend using a tool like <a href="https://www.digitalocean.com/community/tutorials/how-to-use-rsync-to-sync-local-and-remote-directories" target="_blank" rel="noopener noreferrer">rsync</a>, which has built-in error checking and can resume a partial transfer, to move data both locally and remotely. You can use a command like the following to move data locally:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -avhz --progress /source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use a command like the following to copy data from a remote host:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -avhz --progress user@hostname:/source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(Note the use of trailing slashes; rsync is particular about these, and adding or removing a trailing slash can have unintended consequences.)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="avoiding-equivocation">Avoiding Equivocation<a href="#avoiding-equivocation" class="hash-link" aria-label="Direct link to Avoiding Equivocation" title="Direct link to Avoiding Equivocation">​</a></h2><p>There&#x27;s a very small set of behaviors that a miner in Spacemesh is punished for. If a miner simply goes offline or fails to publish a proposal when they&#x27;re eligible to do so they&#x27;ll miss some rewards but they&#x27;re not punished per se. However, if a miner double votes, otherwise known as equivocation, their miner identity is permanently disqualified from participation in consensus and from earning rewards in the future. In a permissionless blockchain like Spacemesh, equivocation is a serious offense that can have severe negative ramifications for the entire network, so this behavior cannot go unsanctioned. Once a miner&#x27;s identity has been cancelled their PoST data is effectively useless. They must generate a new identity and reinitialize their PoST data. For more information, see <a href="https://spacemesh.io/blog/community-clarification-equivocation/" target="_blank" rel="noopener noreferrer">Community Clarification: Equivocation</a>.</p><p>It&#x27;s not difficult to avoid equivocation: simply make sure that the same identity is never attached to two running nodes at the same time. Extra care must be taken any time a miner identity or its PoST data are copied or moved (since the miner identity lives in the PoST data directory).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="moving-an-identity">Moving an Identity<a href="#moving-an-identity" class="hash-link" aria-label="Direct link to Moving an Identity" title="Direct link to Moving an Identity">​</a></h3><p>When moving a miner identity from one place to another, <strong>perform the following steps in the following order:</strong></p><ol><li><strong>Shut down the miner</strong> in the source location</li><li>Copy the files to the new location (see previous section)</li><li><strong>Double-check that the old miner was shut down.</strong> Check again one more time to make sure. If you get this part wrong, you risk permanently disqualifying the miner identity for equivalence and invalidation of the PoST data.</li><li>Make sure the <code>key.bin</code> file is intact in the new location. Compare it to the <code>key.bin</code> file in the old location and make sure the contents are the same. Delete the old <code>key.bin</code> file, or at the very least, rename it or move it to ensure that you don&#x27;t accidentally run the same identity again on the old system.</li><li>Start the miner in the new location. Make sure that you specify the correct <code>smeshing-opts-datadir</code> in the config, and make sure that the other <code>smeshing-opts</code> are the same as they were in the old system, and that they match the contents of the <code>postdata_metadata.json</code> file in the PoST datadir. Make sure that the miner found the data and was able to read it. (You should see the messages <code>post setup completed</code>, <code>loaded the initial post from disk</code>, and <code>verifying the initial post</code> in the log.)</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-multiple-identities">Generating Multiple Identities<a href="#generating-multiple-identities" class="hash-link" aria-label="Direct link to Generating Multiple Identities" title="Direct link to Generating Multiple Identities">​</a></h3><p>You can use one system to generate multiple PoST identities - this is a common usage pattern for a user who wants to, e.g., generate multiple identities on a system with a GPU, then transfer them to other systems. However, once you&#x27;ve moved the PoST data files (<code>postdata_*.bin</code>) to their new location, and copied <code>key.bin</code> as well, <strong>make absolutely certain that <code>key.bin</code> has been removed</strong> in the source location. If the file still exists, the next PoST identity you generate will be identical to the prior one and equivocation may occur as a result.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-management">Log Management<a href="#log-management" class="hash-link" aria-label="Direct link to Log Management" title="Direct link to Log Management">​</a></h2><p>Smapp automatically manages logs for a running node: it compresses and rotates logfiles when they grow large. The node log appears in the Smapp data directory:</p><ul><li><code>~/Library/Application Support/Spacemesh</code> on macOS</li><li><code>~/.config/Spacemesh</code> on Linux</li><li><code>~\AppData\Roaming\Spacemesh</code> on Windows</li></ul><p>If you&#x27;re running <code>go-spacemesh</code> directly, you&#x27;re responsible for log management. As described above, we strongly recommend running the node as a <a href="#system-service">system service</a> on your operating system. Different operating systems and different service managers have different ways of managing logs; you can read about <a href="https://www.loggly.com/ultimate-guide/linux-logging-with-systemd/" target="_blank" rel="noopener noreferrer">how Systemd manages journals on Linux</a>, for example.</p><p>You may find a command such as the following helpful to both display the running node logs and also save them to a file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> go-spacemesh -c config-file.json </span><span class="token operator">|&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> logfile.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One more note about logs: by default, the log level is set to <code>INFO</code> for all node services, in order to keep logfiles manageable. Setting the log level to <code>DEBUG</code> for one or more services can be helpful for troubleshooting. You can accomplish this by adding a <code>logging</code> section to your config file, as such:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;logging&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;atxBuilder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;block-builder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;block-listener&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;nipostBuilder&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;poet&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;post&quot;: &quot;debug&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;p2p&quot;: &quot;error&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For the full list of services, see <a href="https://github.com/spacemeshos/go-spacemesh/blob/develop/config/logging.go" target="_blank" rel="noopener noreferrer"><code>config/logging.go</code></a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-database">State Database<a href="#state-database" class="hash-link" aria-label="Direct link to State Database" title="Direct link to State Database">​</a></h2><p>The node stores all of the network state in a <a href="https://www.sqlite.org/index.html" target="_blank" rel="noopener noreferrer">SQLite</a> database called <code>state.sql</code> (along with a couple of auxiliary files) in the node&#x27;s data directory:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -1 data/7c8cef2b/state.*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql-shm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data/7c8cef2b/state.sql-wal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s possible to explore the contents of this database to understand a node&#x27;s view of the network, especially when the desired data isn&#x27;t available via the API. First, two important notes about working with the state database:</p><p><strong>Note 1: Unlike the API, we make no guarantees that the state database schema will remain the same.</strong> It will likely evolve over time. Thus, while it&#x27;s perfectly okay to explore the state database for troubleshooting, we strongly recommend against building or deploying any production applications that rely on it.</p><p><strong>Note 2: Never, under any circumstances, modify the state of a running node.</strong> Making even a small change runs the risk of totally corrupting the state database, which in the worst case would require that a node be resynced from scratch, a process that can take a long time (and during which time a miner node isn&#x27;t eligible for rewards). As such, before even opening the state database, <strong>make a copy of the file</strong> and work with the copy only to make sure you don&#x27;t accidentally modify the live database.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reading-the-state-database">Reading the State Database<a href="#reading-the-state-database" class="hash-link" aria-label="Direct link to Reading the State Database" title="Direct link to Reading the State Database">​</a></h3><p>There are multiple ways to read data from a SQLite database. We recommend either using the official <a href="https://sqlite.org/cli.html" target="_blank" rel="noopener noreferrer"><code>sqlite3</code></a> program, or else the cross-platform, open source UI alternative <a href="https://sqlitebrowser.org/" target="_blank" rel="noopener noreferrer">DB Browser</a>. If you open the state database in the DB Browser you should see something like the following:</p><p><img loading="lazy" src="https://github.com/spacemeshos/wiki/assets/3316532/ad3eb4f3-af7b-49eb-8842-f46fe707f545" alt="image" class="img_ev3q"></p><p>The full extent of queries you can run against this database is beyond the scope of this document, but as a simple example, here&#x27;s how you&#x27;d look up the coinbase associated with a given smesher, and thus find that smesher&#x27;s rewards using the coinbase:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTINCT</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">coinbase</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> atxs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;F353545DB955F5A359F406ACAB847408D40530A6782BE436553FE521033A42EC&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">000000006</span><span class="token plain">EE7C594D665EABFD653CF6920C7E24A3B8562C7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> layer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> total_reward </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> rewards </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> HEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">coinbase</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;000000006EE7C594D665EABFD653CF6920C7E24A3B8562C7&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">8090</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">266137048118</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="backing-up-state">Backing up State<a href="#backing-up-state" class="hash-link" aria-label="Direct link to Backing up State" title="Direct link to Backing up State">​</a></h3><p>It can be helpful to create snapshots or backup versions of a node&#x27;s state so that data may be restored more quickly in case of corruption or failure (rather than needing to resync from scratch, which is time consuming). This process is very straightforward: just create a copy of the files shown above, i.e., the <code>state.*</code> files inside the node&#x27;s data directory.</p><p>Due to SQLite&#x27;s <a href="https://www.sqlite.org/atomiccommit.html" target="_blank" rel="noopener noreferrer">atomic commit</a> feature it shouldn&#x27;t be necessary to stop the node before taking a snapshot, but if you want to be extra careful you may do so.</p><p>Also note that <a href="https://serverfault.com/questions/307296/which-filesystems-offer-snapshot-functionality-for-users-to-recover-data" target="_blank" rel="noopener noreferrer">certain filesystems</a> make snapshotting easier or even automatic.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clearing-state">Clearing State<a href="#clearing-state" class="hash-link" aria-label="Direct link to Clearing State" title="Direct link to Clearing State">​</a></h3><p>From time to time, such as if the state database becomes corrupt or if you simply want to resync your node from genesis, it becomes necessary to clear the state entirely. In order to do this, you should:</p><ol><li>Stop the node. Ensure that it&#x27;s exited cleanly and completely.</li><li>Remove the files shown above, i.e., the <code>state.*</code> files inside the node&#x27;s data directory. Note: don&#x27;t remove the other contents of the data directory as it also contains, e.g., P2P data.</li><li>Restart the node. You should see it begin to sync from genesis.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="copying-state">Copying State<a href="#copying-state" class="hash-link" aria-label="Direct link to Copying State" title="Direct link to Copying State">​</a></h3><p>There&#x27;s no &quot;private&quot; data, i.e., data that&#x27;s specific to one miner or one node, in the state database. This means that you can copy one trusted node&#x27;s database to another node as a quick-and-dirty &quot;quick sync&quot; option, rather than letting the nodes sync the old fashioned way. To do this:</p><ol><li>Make sure both nodes are running the same version of go-spacemesh.</li><li>Stop <strong>both nodes.</strong> Ensure that they&#x27;ve exited cleanly and completely.</li><li>Remove the state files entirely from node B, i.e., the destination node, by following the instructions above.</li><li>Copy the same files, i.e., the <code>state.*</code> files inside the data directory of node A (i.e., the source node) to the data directory of node B. It&#x27;s safe to do this from one system to another even if the two systems are on different architectures or different operating systems.</li><li>Restart both nodes.</li></ol><p>Note: by directly copying the state database you bypass the protections in the protocol and the node that would prevent your node from accepting bad state or bad transactions. For this reason it&#x27;s essential that you <strong>only copy the state from a trusted node,</strong> i.e., a node that you run yourself, and that you <strong>never blindly accept state data from a third party.</strong> Otherwise, you may end up with corrupt or incorrect state.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-gpu">Cloud GPU<a href="#cloud-gpu" class="hash-link" aria-label="Direct link to Cloud GPU" title="Direct link to Cloud GPU">​</a></h2><p>Miners without local access to a GPU may choose to instead perform GPU initialization remotely using one or multiple (see next section) GPUs. This can be done using the infrastructure of any cloud compute provider that offers a modern GPU platform. Note that cloud providers that specialize in GPUs and other types of high-performance computing will often offer better prices and tooling than general-purpose cloud compute platforms like Azure, AWS, or GCP. While we cannot vouch for any particular provider and have no affiliation with any such provider, in our testing we&#x27;ve had particular luck with <a href="https://www.runpod.io/" target="_blank" rel="noopener noreferrer">Runpod</a> and have also heard good things about <a href="https://www.coreweave.com/" target="_blank" rel="noopener noreferrer">Coreweave</a> and <a href="https://vast.ai/" target="_blank" rel="noopener noreferrer">Vast</a>.</p><p>As a rule of thumb, you&#x27;ll want access to an instance that:</p><ul><li>has a modern GPU (e.g., RTX 3090 or 4090; see <a href="#post-initialization-1">Requirements: PoST Initialization</a>)</li><li>has plenty of storage, around 10% more than you plan to initialize (e.g., if you plan to initialize 1 TiB of PoST storage, we recommend choosing an instance with at least 1.1 TiB)</li><li>has a very fast Internet connection with plenty of bandwidth</li><li>doesn&#x27;t charge a lot for data egress</li></ul><p>Most GPU providers simply run a docker container for you. You may find <a href="https://hub.docker.com/r/lrettig/nvidia-opencl" target="_blank" rel="noopener noreferrer">this barebones image</a> useful; you can use it as <code>docker.io/lrettig/nvidia-opencl:latest</code> in a cloud host, and you can find the <a href="https://github.com/lrettig/spacemesh-nvidia-opencl/blob/main/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile here</a>. It simply installs the packages required for OpenCL on Ubuntu and then downloads <a href="https://github.com/spacemeshos/post/releases" target="_blank" rel="noopener noreferrer"><code>postcli</code></a>. Here is <a href="https://github.com/smeshcloud/nvidia-cuda-opencl/blob/main/Dockerfile" target="_blank" rel="noopener noreferrer">an alternative</a>.</p><p>Bear in mind that generating the PoST files is only half the battle; you also need to download them! Some providers charge a lot for data egress, which can get expensive quickly when downloading many terabytes of data. And, in order to move the data in a reasonable amount of time, you&#x27;ll want to find a cloud instance with plenty of bandwidth, ideally more than 1gbit/sec. Any slower than this and you&#x27;ll wait forever to download the files. Be wary of &quot;community&quot; run nodes on cloud marketplaces such as Runpod and Vast since while they may be cheaper these often don&#x27;t have the requisite bandwidth.</p><p>As <a href="#moving-post-files">described above</a>, we recommend using a utility with features such as error checking and resume like rsync to download files. rsync works well as long as you have <code>ssh</code> access to the cloud host. Here&#x27;s a sample rsync command that uses an ssh identity file and connects to a particular remote port:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ssh -i ~/.ssh/id_ed25519 -p 22164&quot;</span><span class="token plain"> -avhz --progress user@host:/source/directory/ /destination/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Remember that you can begin downloading the PoST data files before initialization is complete! Just run rsync again after it finishes or, better yet, run it in an automatic loop to maximize efficiency:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rsync</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ssh -i ~/.ssh/id_ed25519 -p 22164&quot;</span><span class="token plain"> -avhz --progress user@host:/source/directory/ /destination/directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sleep</span><span class="token plain"> </span><span class="token number">300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-initialization">Parallel Initialization<a href="#parallel-initialization" class="hash-link" aria-label="Direct link to Parallel Initialization" title="Direct link to Parallel Initialization">​</a></h2><p>While by default initialization occurs using a single GPU, it&#x27;s possible to initialize a single identity using many GPUs in parallel, on a single system or on multiple systems. This can be done using <code>postcli</code>: specify the desired number of units, count the total number of init files, then initialize a subset on each GPU/each system, e.g.:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./postcli -numUnits </span><span class="token number">100</span><span class="token plain"> -printNumFiles</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">1600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On Machine A:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./postcli -numUnits </span><span class="token number">100</span><span class="token plain"> -id </span><span class="token operator">&lt;</span><span class="token plain">id</span><span class="token operator">&gt;</span><span class="token plain"> -commitmentAtxId </span><span class="token operator">&lt;</span><span class="token plain">id</span><span class="token operator">&gt;</span><span class="token plain"> -toFile </span><span class="token number">799</span><span class="token plain"> -datadir ./dataA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On Machine B:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./postcli -numUnits </span><span class="token number">100</span><span class="token plain"> -id </span><span class="token operator">&lt;</span><span class="token plain">id</span><span class="token operator">&gt;</span><span class="token plain"> -commitmentAtxId </span><span class="token operator">&lt;</span><span class="token plain">id</span><span class="token operator">&gt;</span><span class="token plain"> -fromFile </span><span class="token number">800</span><span class="token plain"> -datadir ./dataB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When combining the files, care must be taken to manually merge the metadata contained in the <code>post_metadata.json</code> files since each will contain a different nonce value and the smallest nonce must be chosen. For the same reason we strongly recommend that you not perform initialization <strong>using multiple GPUs on a single system using the same PoST data directory,</strong> because the nonces found by one process will be overwritten by those found by another.</p><p>See <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli" target="_blank" rel="noopener noreferrer">the postcli README</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-drives">Multiple Drives<a href="#multiple-drives" class="hash-link" aria-label="Direct link to Multiple Drives" title="Direct link to Multiple Drives">​</a></h2><p>At present it&#x27;s not possible to naively split a single identity across multiple drives or filesystems. We hope to add this feature soon. In the meantime you have two possibilities: run multiple identities, or join multiple filesystems into a single logical filesystem at the hardware or OS level.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-identities">Multiple Identities<a href="#multiple-identities" class="hash-link" aria-label="Direct link to Multiple Identities" title="Direct link to Multiple Identities">​</a></h3><p>Running multiple identities is explained in <a href="#identity-management">Identity Management</a> and <a href="#multiple-nodes">Multiple Nodes</a>. This has the advantage that you don&#x27;t need to mess with your filesystem configuration at all, and that you can <a href="#post-initialization-2">initialize</a> and <a href="#proof-generation">generate proofs</a> for each identity more easily in parallel. It has the downside that you need to run multiple nodes, which will consume multiples of the <a href="#requirements">required resources</a> that a single node consumes. Also, since it&#x27;s in the interest of the network to reduce the number of identities as much as possible, we&#x27;ll be adding incentives for larger ATXs (generated by larger identities) and disincentives for many small ATXs. Please bear this in mind when you decide how many identities to run.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="joining-filesystems">Joining Filesystems<a href="#joining-filesystems" class="hash-link" aria-label="Direct link to Joining Filesystems" title="Direct link to Joining Filesystems">​</a></h3><p>There are many ways to combine multiple, physical filesystems into a single &quot;logical&quot; filesystem and the best way to do this will depend on your hardware, your operating systems, you degree of technical expertise, and your needs. Some miners have had success with <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_5" target="_blank" rel="noopener noreferrer">RAID5</a>; bear in mind that it&#x27;s possible to run RAID in either <a href="https://www.techtarget.com/searchstorage/tip/Key-differences-in-software-RAID-vs-hardware-RAID" target="_blank" rel="noopener noreferrer">hardware or software</a>, with various tradeoffs. Linux users can rely on <a href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_(Linux)" target="_blank" rel="noopener noreferrer">LVM</a>, which has wide support in modern distributions.</p><p>This has the advantage that you can run a single node, rather than many, and that, if configured correctly, you may achieve much faster read speed (see <a href="#very-large-identities">Very Large Identities</a>) than you can with a single drive. It has the disadvantage of requiring more configuring at the operating system and filesystem level; miners who aren&#x27;t comfortable doing so may prefer to instead run multiple identities.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="corrupt-post-data">Corrupt PoST Data<a href="#corrupt-post-data" class="hash-link" aria-label="Direct link to Corrupt PoST Data" title="Direct link to Corrupt PoST Data">​</a></h2><p>One of the realities of hard drives is that, once in a while, they fail, resulting in corrupt data. Data corruption can also occur while <a href="#moving-post-files">copying or moving</a> data across systems. Hopefully you&#x27;ll never have to deal with this situation, but if it does happen, you&#x27;ll most likely find out when a message like the following appears in your log:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2023-09-18T03:37:09.147-0400    INFO    abcde.nipostValidator   Found proof for nonce: 0, pow: 22517998136898104 with [96506732, 8522344264, 15809824782, 17090809665, 22898048404, 23339075780, 33564380939, 37517090594, 38587115133, 42519923294, 47489969603, 66776374486, 85751204605, 97571767596, 98954096617, 103466964513, 105410396815, 108719413993, 110747747703, 114712568823, 122975084397, 128938645449, 135064014126, 137417405566, 137527071596, 142672661935, 145176618414, 149504039139, 150155464780, 156195137948, 162912656308, 188599527912, 192691123424, 196101601537, 196889191957, 202704285017, 204635877880] indices     {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;nipostValidator&quot;, &quot;module&quot;: &quot;post::prove&quot;, &quot;file&quot;: &quot;src/prove.rs&quot;, &quot;line&quot;: 323}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2023-09-18T03:37:09.353-0400    INFO    abcde.post      proving: generated proof        {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;post&quot;}                                                                                                                         2023-09-18T03:37:09.353-0400    INFO    abcde.atxBuilder        created the initial post        {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;atxBuilder&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2023-09-18T03:37:09.353-0400    INFO    abcde.atxBuilder        verifying the initial post      {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;atxBuilder&quot;, &quot;post&quot;: {&quot;nonce&quot;: 0, &quot;indices&quot;: &quot;6c93c00500d229fe7ee0806ce53a043dc4ea0f947dd454053182c75bb1f07c097d887cc5f0227da6f8fb8897a2987932dcf6e9b05873ba303efd8a2bf7134bc1eead95fefaa1708558725c608f02f38a58baa60b54765748919cdd8f9bd56a6ddfe2a15cf2e55581e7d21427f7f9d1dcfa7f6c934005e06b03fd4de85a36d31c8e638a3c8b4c90f6f522672a7d1749bb9de55ea2a7a1a5afe03449dd6c403e246a5b612a78dd66b577c8bcf8b13fa52f&quot;}, &quot;metadata&quot;: {&quot;Challenge&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;LabelsPerUnit&quot;: 4294967296}, &quot;name&quot;: &quot;atxBuilder&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2023-09-18T03:37:09.410-0400    ERROR   abcde.nipostValidator   Proof is invalid: MSB value for index: 137527071596 doesn&#x27;t satisfy difficulty: 207 &gt; 0 (label: [215, 101, 80, 15, 36, 236, 60, 243, 203, 157, 178, 129, 73, 177, 132, 65])       {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;nipostValidator&quot;, &quot;module&quot;: &quot;post::post_impl&quot;, &quot;file&quot;: &quot;ffi/src/post_impl.rs&quot;, &quot;line&quot;: 242}                                                                                                                                                                                            2023-09-18T03:37:09.413-0400    FATAL   abcde.atxBuilder        initial POST proof is invalid. Probably the initialized POST data is corrupted. Please verify the data with postcli and regenerate the corrupted files.   {&quot;node_id&quot;: &quot;abcde&quot;, &quot;module&quot;: &quot;atxBuilder&quot;, &quot;errmsg&quot;: &quot;verify PoST: invalid proof&quot;, &quot;name&quot;: &quot;atxBuilder&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This message indicates that, despite the presence of a complete identity, the miner was unable to generate a PoST proof for a particular epoch due to corruption in the PoST data. The best way to verify this is to run <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli" target="_blank" rel="noopener noreferrer"><code>postcli</code></a> in verify mode:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> postcli -datadir /Volumes/post/7c8cef2b -fromFile </span><span class="token number">531</span><span class="token plain"> -verify -fraction </span><span class="token number">0.01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">/09/18 </span><span class="token number">13</span><span class="token plain">:51:59 cli: verifying key.bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">/09/18 </span><span class="token number">13</span><span class="token plain">:51:59 cli: key.bin is valid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">/09/18 </span><span class="token number">13</span><span class="token plain">:51:59 cli: verifying POS data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">-09-18T13:51:59.504-0400    INFO    verifying POS data </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> /Volumes/post/7c8cef2b  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;module&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;post::pos_verification&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;src/pos_verification.rs&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;line&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">34</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">-09-18T13:51:59.504-0400    INFO    verifying POS files </span><span class="token number">531</span><span class="token plain"> -</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">927</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;module&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;post::pos_verification&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;src/pos_verification.rs&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;line&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">-09-18T13:51:59.504-0400    INFO    verifying </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> /Volumes/post/7c8cef2b/postdata_531.bin      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;module&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;post::pos_verification&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;src/pos_verification.rs&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;line&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">43</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">-09-18T13:51:59.504-0400    INFO    verifying </span><span class="token number">26843</span><span class="token plain"> labels  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;module&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;post::pos_verification&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;src/pos_verification.rs&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;line&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">66</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">-09-18T13:52:02.348-0400    INFO    POS data is invalid: invalid label </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> </span><span class="token number">531</span><span class="token plain"> at offset </span><span class="token number">126368</span><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;module&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;post::initialization&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ffi/src/initialization.rs&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;line&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">242</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2023</span><span class="token plain">/09/18 </span><span class="token number">13</span><span class="token plain">:52:02 cli: invalid POS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can do this for an entire identity, or only for a subset of files (using <code>-fromFile</code> and <code>-toFile</code>; see the <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli" target="_blank" rel="noopener noreferrer">README</a> for more information). If nothing else is touching the drive (e.g., if the node is shut down and the drive isn&#x27;t being used for any other purpose), then running <code>postcli verify</code> with <code>-fraction 0.01</code> should be quite quick; you can run with a larger fraction for a more thorough check. Note also that multiple files may be corrupt; <code>postcli verify</code> will quit after detecting a single corrupt file, and you can restart it with a higher <code>-fromFile</code> to continue the process. Serious miners may wish to run such a verification process periodically to detect corruption issues before they lead to failures in proof generation and lost rewards.</p><p>Once corrupt data is detected, the only option is to delete and regenerate the affected files. If the files are deleted and the node is restarted, it&#x27;ll automatically restart the PoST initialization process to fill in the missing data, or this can be done manually using <code>postcli</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="post-metadata">PoST Metadata<a href="#post-metadata" class="hash-link" aria-label="Direct link to PoST Metadata" title="Direct link to PoST Metadata">​</a></h2><p>The PoST data directory contains a file called postdata_metadata.json that contains metadata related to the identity and data files:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; cat ~/post/7c8cef2b/postdata_metadata.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NodeId&quot;: &quot;3hcrKr45D5H8GrRikkZMztvKjvQpviUwVqRVMgh0jqk=&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;CommitmentAtxId&quot;: &quot;nuv/Ajq7F8y3dcYC2q3o7XCPClDTFJpCgBGE9bdPKGU=&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;LabelsPerUnit&quot;: 4294967296,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NumUnits&quot;: 15,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;MaxFileSize&quot;: :4294967296,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;Nonce&quot;: 34659695032,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;NonceValue&quot;: &quot;0000000006db3dc6d84ff41b8acb588d&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In general you should never touch this file or change any of these values, other than when combining data from a <a href="#parallel-initialization">parallel initialization</a>, which requires manually finding the lowest nonce.</p><p>It&#x27;s <em>never safe</em> to change the <code>NodeId</code>, <code>CommitmentAtxId</code>, <code>LabelsPerUnit</code>, or <code>MaxFileSize</code> values. If you increase <code>MaxUnits</code> and run <code>postcli</code> or <code>go-spacemesh</code>, it&#x27;ll continue PoST initialization and generate more files; this is safe to do unless/until your miner has already generated and broadcast an ATX, after which it cannot be changed. If you decrease <code>MaxUnits</code> and run <code>postcli</code> or <code>go-spacemesh</code>, they will delete existing files to match the config value.</p><p>It&#x27;s always safe to change the <code>Nonce</code> and <code>NonceValue</code> to any valid values, even after generating and broadcasting an ATX. If, for instance, you discover that you hadn&#x27;t configured the lowest nonce, you can add it later. Note that this will have no impact upon rewards; it&#x27;s just future-proofing in case you change the PoST size in future (once this is allowed). See <a href="https://github.com/spacemeshos/post/tree/develop/cmd/postcli#searching-for-a-lost-vrf-nonce" target="_blank" rel="noopener noreferrer">Searching for a lost VRF nonce</a>.</p><p>Note that this nonce value, known as a VRF Nonce, has nothing to do with the nonce value <a href="#fine-tuning-proving">used in proving</a>. The VRF Nonce is used to help determine when your node is eligible to participate in block proposal and the Tortoise beacon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="networking">Networking<a href="#networking" class="hash-link" aria-label="Direct link to Networking" title="Direct link to Networking">​</a></h2><p>Most miners should never need to think much about their network settings. The Spacemesh node software ships with a reasonable default set of parameters that should work well for most node operators and most miners, and the software is built on top of the popular <a href="https://libp2p.io/" target="_blank" rel="noopener noreferrer">libp2p network stack</a> which includes many useful features and support for things like peer discovery and NAT traversal.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nat-traversal">NAT Traversal<a href="#nat-traversal" class="hash-link" aria-label="Direct link to NAT Traversal" title="Direct link to NAT Traversal">​</a></h3><p>When the node boots up, by default it tries to <a href="https://docs.libp2p.io/concepts/nat/overview/#automatic-router-configuration" target="_blank" rel="noopener noreferrer">automatically configure an open port</a> that will allow it to listen for inbound connections. While this isn&#x27;t strictly required for participation in the network, it&#x27;s strongly encouraged, since without an open inbound port your node will not be &quot;routable&quot; or &quot;dialable&quot;, meaning it can only establish outbound connections (but not accept inbound ones). This damages the health of the entire p2p network. Note that, in addition to this feature, if you have a firewall running either locally or on your router, you&#x27;ll need to manually open the &quot;listen&quot; port, which is 7513 by default. Firewall configurations vary from system to system; see <a href="https://github.com/spacemeshos/testnet-guide/blob/master/netconfig.md" target="_blank" rel="noopener noreferrer">Network configuration</a> for more information.</p><p>You can disable NAT traversal with the <code>--disable-natport</code> commandline flag or config variable, and you can configure a different listen port using <code>--listen</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&gt;</span><span class="token plain"> go-spacemesh -h</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      --listen string                                 address </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> listening </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">default </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/ip4/0.0.0.0/tcp/7513&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      --disable-natport                               disable nat port-mapping </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">if enabled upnp protocol is used to negotiate external port with router</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="number-of-connections">Number of Connections<a href="#number-of-connections" class="hash-link" aria-label="Direct link to Number of Connections" title="Direct link to Number of Connections">​</a></h3><p>By default the node attempts to maintain 20-100 peer connections, including both inbound and outbound. The number of inbound and outbound connections is governed by the <a href="https://github.com/spacemeshos/go-spacemesh/blob/475b05b6a8900424bedf5b9086881920ed035b8b/p2p/host.go#L75-L106" target="_blank" rel="noopener noreferrer">p2p config</a>. Miners wishing to manage the details of their node&#x27;s participation in the p2p network may wish to tweak the following settings:</p><ul><li><code>listen</code>: as mentioned above, this is the inbound connection port</li><li><code>disable-natport</code> and <code>p2p-holepunching</code>: as mentioned above, these features can be used for NAT traversal. See <a href="https://docs.libp2p.io/concepts/nat/overview/" target="_blank" rel="noopener noreferrer">What are NATs</a> for more information.</li><li><code>min-peers</code>: when the node is connected to fewer than this number of peers, the discovery process will continue to run to find new peers to connect to</li><li><code>low-peers</code> and <code>high-peers</code>: when the number of peer connections exceeds <code>high-peers</code>, connections will be pruned until the number falls to <code>low-peers</code></li><li><code>inbound-fraction</code>: the node will not allow more than <code>inbound-fraction x high-peers</code> inbound connections at any given time.</li><li><code>outbound-fraction</code>: the node will not allow more than <code>outbound-fraction x high-peers</code> outbound connections at any given time.</li><li><code>direct</code> and <code>bootnodes</code>: can be used to manage public and private nodes; see next section.</li></ul><p>As usual, any of these settings may be passed as commandline flags to <code>go-spacemesh</code>, or may be included in the <a href="https://github.com/spacemeshos/wiki/wiki/Smesher-Guide#config" target="_blank" rel="noopener noreferrer">config file</a>.</p><p>Even more settings are available. See the <a href="https://github.com/spacemeshos/go-spacemesh/blob/475b05b6a8900424bedf5b9086881920ed035b8b/p2p/host.go#L75-L106" target="_blank" rel="noopener noreferrer">p2p config</a> and <a href="https://docs.libp2p.io/" target="_blank" rel="noopener noreferrer">the libp2p docs</a> for more information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-nodes">Private Nodes<a href="#private-nodes" class="hash-link" aria-label="Direct link to Private Nodes" title="Direct link to Private Nodes">​</a></h3><p>A miner running <a href="#multiple-nodes">multiple nodes</a> or <a href="#identity-management">multiple identities</a> may wish to manually configure how the nodes peer with and communicate with one another. In other words, miners can configure a custom network topology among their own nodes. One very common configuration is to have one or more public &quot;gateway&quot; nodes that are publicly accessible and responsible for communicating with the outside world that relay information from the public p2p network to many private nodes. Such a configuration can save an enormous amount of bandwidth compared to each of several nodes joining the public p2p network directly.</p><p>Such a configuration is achieved through the use of the <code>bootnodes</code> and <code>direct</code> parameters in the <code>p2p</code> config. The process is fully documented in the <a href="https://github.com/spacemeshos/go-spacemesh/blob/develop/p2p/README.md" target="_blank" rel="noopener noreferrer">go-spacemesh p2p README</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-optimizations-while-running-public-private-nodes-setup">Performance optimizations while running public-private nodes setup<a href="#performance-optimizations-while-running-public-private-nodes-setup" class="hash-link" aria-label="Direct link to Performance optimizations while running public-private nodes setup" title="Direct link to Performance optimizations while running public-private nodes setup">​</a></h4><p>If you&#x27;re running a public-private nodes setup, you may wish to tweak the following settings to improve the CPU resource usage of your <strong>private</strong> nodes.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-verifying-post-on-private-nodes">Disabling verifying POST on private nodes<a href="#disabling-verifying-post-on-private-nodes" class="hash-link" aria-label="Direct link to Disabling verifying POST on private nodes" title="Direct link to Disabling verifying POST on private nodes">​</a></h5><p>Verification of POST proofs in ATX that come from the network is significantly hard work for the CPU. In a setup where only some nodes are public, it makes no sense to repeat this work on the private nodes if they can trust the public nodes to do the work honestly.</p><p>Post verification can be disabled completely on selected nodes by using <code>--smeshing-opts-verifying-disable</code> CLI flag or the following config entry:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;smeshing&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;smeshing-verifying-opts&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;smeshing-opts-verifying-disable&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>[!WARNING]<!-- -->
Using this is safe <strong>only on the private</strong> nodes because the <strong>public</strong> node will verify ATXs for it. Given that the private nodes are only connected to public nodes, there is no risk involved here. It is strongly <strong>discouraged</strong> to use this setting on <strong>public</strong> nodes.</p></blockquote><h5 class="anchor anchorWithStickyNavbar_LWe7" id="changing-k3-parameter">Changing k3 parameter<a href="#changing-k3-parameter" class="hash-link" aria-label="Direct link to Changing k3 parameter" title="Direct link to Changing k3 parameter">​</a></h5><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&quot;post&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;post-k3&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It will significantly lower the CPU requirements while verifying the incoming ATXs.</p><p>By default <code>k3</code> parameter is equal to <code>k2</code> which is currently 37. Setting it to a lower value than 37 will check fewer labels in the proofs and therefore speed up the checks. The downside is that it will lower the security of the ATX verification. The lower the value the lower the security. Setting it to 0 will disable the proof labels verification completely. The node will still verify the k2pow with RandomX though.</p><blockquote><p>[!WARNING]<!-- -->
Setting k3 to 0 is safe to use on <strong>only on the private</strong> nodes because the <strong>public</strong> node will verify whole proofs and not just one label as set in the config above. And given that the private nodes are only connected to public nodes then there is no risk involved here. It is strongly <strong>discouraged</strong> to use this setting on <strong>public</strong> nodes.</p></blockquote><h5 class="anchor anchorWithStickyNavbar_LWe7" id="randomx-fast-mode">RandomX Fast mode<a href="#randomx-fast-mode" class="hash-link" aria-label="Direct link to RandomX Fast mode" title="Direct link to RandomX Fast mode">​</a></h5><p>To improve ATX verification speed on <strong>public</strong> nodes you can use the following setting. It will require roughly additional 2GB of RAM per node used only during ATX verification.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&quot;smeshing&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;smeshing-verifying-opts&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;smeshing-opts-verifying-powflags&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you have spare ram on the private nodes then that setting is safe to set there too. Please remember about the requirement of 2GiB extra memory per node though.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-fine-tuning-of-a-node">Performance fine tuning of a node<a href="#performance-fine-tuning-of-a-node" class="hash-link" aria-label="Direct link to Performance fine tuning of a node" title="Direct link to Performance fine tuning of a node">​</a></h2><p>Besides <a href="#performance-optimisations-while-running-public-private-nodes-setup">Performance optimisations while running public-private nodes setup</a> there are few other settings that can be used to fine tune the performance of a node.
Please note that these are not directly related to the proving performance but they <em>may</em> impact it depending on the system, setup, hardware etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-workers">Verifying workers<a href="#verifying-workers" class="hash-link" aria-label="Direct link to Verifying workers" title="Direct link to Verifying workers">​</a></h3><p>Wherever your node will get new ATX it needs to validate it. This is done by the verifying workers. By default there are half of the CPU cores assigned workers that are used to validate the ATXs. You can set the number of workers by setting the following config:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">&quot;smeshing&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&quot;smeshing-verifying-opts&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;smeshing-opts-verifying-min-workers&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;smeshing-opts-verifying-workers&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>smeshing-opts-verifying-min-workers</code> defines the minimal number of workers. Node will automatically scale down to that number WHEN it&#x27;s proving. When it&#x27;s not proving it will use up to <code>smeshing-opts-verifying-workers</code> workers.</p><p>In order to minimize system impact, <code>smeshing-opts-verifying-min-workers</code> can be configured to <code>1</code> and <code>smeshing-opts-verifying-workers</code> can also be set to <code>1</code>. While these settings ensure the lowest strain on system resources, it is important to note that they will result in slower ATX (Activation Transaction) verification, consequently affecting the synchronization speed.</p><p>For those who are actively smeshing on the node, it is advisable to set the <code>smeshing-opts-verifying-workers</code> to the same value as <code>smeshing-opts-proving-workers</code>. This configuration is optimal for reducing the potential negative performance impact on smeshing for other nodes, particularly if the given node has completed its proof of space-time.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="randomx-fast-mode-1">RandomX fast mode<a href="#randomx-fast-mode-1" class="hash-link" aria-label="Direct link to RandomX fast mode" title="Direct link to RandomX fast mode">​</a></h3><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token key atrule">&quot;smeshing&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;smeshing-verifying-opts&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">&quot;smeshing-opts-verifying-powflags&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similarly as in the previous section you can set the RadomX mode. RandomX is also used with every incoming ATX. Setting that to <code>14</code> from the default <code>10</code> makes it significanly faster but in expense of 2GiB extra ram used. In most setups that&#x27;s not needed but if you have spare ram then it&#x27;s safe to use.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-troubleshooting">Additional troubleshooting<a href="#additional-troubleshooting" class="hash-link" aria-label="Direct link to Additional troubleshooting" title="Direct link to Additional troubleshooting">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="timesync-peers-are-not-time-synced"><code>timesync: peers are not time synced</code><a href="#timesync-peers-are-not-time-synced" class="hash-link" aria-label="Direct link to timesync-peers-are-not-time-synced" title="Direct link to timesync-peers-are-not-time-synced">​</a></h3><p>Please make sure that your system clock is synced with the internet. Please refer to time synchronization instructions for your operating system.</p><p>If you&#x27;re 100% certain that your time is correct you can disable the time sync check by setting the following config:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;time&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">&quot;peersync&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">&quot;disable&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="my-node-uses-too-much-memory-and-i-dont-know-why">My node uses too much memory and I don&#x27;t know why<a href="#my-node-uses-too-much-memory-and-i-dont-know-why" class="hash-link" aria-label="Direct link to My node uses too much memory and I don&#x27;t know why" title="Direct link to My node uses too much memory and I don&#x27;t know why">​</a></h3><p>Please add a <code>&quot;pprof-server&quot;: true</code>, to the config at the main level or add <code>--pprof-server</code> to the command line. Restart the node and then visit <a href="http://127.0.0.1:6060/debug/pprof/profile?seconds=30" target="_blank" rel="noopener noreferrer">http://127.0.0.1:6060/debug/pprof/profile?seconds=30</a> and <a href="http://127.0.0.1:6060/debug/pprof/heap" target="_blank" rel="noopener noreferrer">http://127.0.0.1:6060/debug/pprof/heap</a> in your default browser and download the files. Please share then these files on discord or github issue.</p><p>Advanced users can use <code>go tool pprof http://localhost:6060/debug/pprof/heap</code> to see what is using the memory.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/start"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting Started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/start/smapp/install"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Install Smapp</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#full-node" class="table-of-contents__link toc-highlight">Full Node</a></li><li><a href="#post-initialization" class="table-of-contents__link toc-highlight">PoST Initialization</a></li><li><a href="#ongoing-mining" class="table-of-contents__link toc-highlight">Ongoing Mining</a></li><li><a href="#commitmentatxid" class="table-of-contents__link toc-highlight"><code>commitmentAtxId</code></a></li><li><a href="#smapp" class="table-of-contents__link toc-highlight">Smapp</a><ul><li><a href="#custom-config" class="table-of-contents__link toc-highlight">Custom config</a></li></ul></li><li><a href="#system-service" class="table-of-contents__link toc-highlight">System Service</a></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#updates" class="table-of-contents__link toc-highlight">Updates</a></li><li><a href="#opencl" class="table-of-contents__link toc-highlight">OpenCL</a></li><li><a href="#initialization-speed" class="table-of-contents__link toc-highlight">Initialization Speed</a></li><li><a href="#choice-of-filesystem" class="table-of-contents__link toc-highlight">Choice of Filesystem</a></li><li><a href="#number-of-units" class="table-of-contents__link toc-highlight">Number of Units</a></li><li><a href="#starting-initialization" class="table-of-contents__link toc-highlight">Starting Initialization</a><ul><li><a href="#choosing-a-provider" class="table-of-contents__link toc-highlight">Choosing a Provider</a></li></ul></li><li><a href="#ticks-and-weight" class="table-of-contents__link toc-highlight">Ticks and Weight</a></li><li><a href="#timing" class="table-of-contents__link toc-highlight">Timing</a></li><li><a href="#running-a-poet-server" class="table-of-contents__link toc-highlight">Running a PoET Server</a></li><li><a href="#updating-the-configuration-of-a-node-to-use-different-poets" class="table-of-contents__link toc-highlight">Updating the configuration of a node to use different PoETs</a><ul><li><a href="#switching-phase" class="table-of-contents__link toc-highlight">Switching phase</a></li><li><a href="#timing-a-phase-switch" class="table-of-contents__link toc-highlight">Timing a phase switch</a></li></ul></li><li><a href="#estimated-rewards" class="table-of-contents__link toc-highlight">Estimated Rewards</a></li><li><a href="#eligibility-slots" class="table-of-contents__link toc-highlight">Eligibility Slots</a></li><li><a href="#earned-rewards" class="table-of-contents__link toc-highlight">Earned Rewards</a></li><li><a href="#missed-rewards" class="table-of-contents__link toc-highlight">Missed Rewards</a></li><li><a href="#reward-lifecycle" class="table-of-contents__link toc-highlight">Reward Lifecycle</a></li><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li><li><a href="#increasing-and-decreasing-storage" class="table-of-contents__link toc-highlight">Increasing and Decreasing Storage</a></li><li><a href="#very-large-identities" class="table-of-contents__link toc-highlight">Very Large Identities</a></li><li><a href="#fine-tuning-proving" class="table-of-contents__link toc-highlight">Fine-tuning Proving</a></li><li><a href="#identity-management" class="table-of-contents__link toc-highlight">Identity Management</a></li><li><a href="#moving-post-files" class="table-of-contents__link toc-highlight">Moving PoST files</a></li><li><a href="#avoiding-equivocation" class="table-of-contents__link toc-highlight">Avoiding Equivocation</a><ul><li><a href="#moving-an-identity" class="table-of-contents__link toc-highlight">Moving an Identity</a></li><li><a href="#generating-multiple-identities" class="table-of-contents__link toc-highlight">Generating Multiple Identities</a></li></ul></li><li><a href="#log-management" class="table-of-contents__link toc-highlight">Log Management</a></li><li><a href="#state-database" class="table-of-contents__link toc-highlight">State Database</a><ul><li><a href="#reading-the-state-database" class="table-of-contents__link toc-highlight">Reading the State Database</a></li><li><a href="#backing-up-state" class="table-of-contents__link toc-highlight">Backing up State</a></li><li><a href="#clearing-state" class="table-of-contents__link toc-highlight">Clearing State</a></li><li><a href="#copying-state" class="table-of-contents__link toc-highlight">Copying State</a></li></ul></li><li><a href="#cloud-gpu" class="table-of-contents__link toc-highlight">Cloud GPU</a></li><li><a href="#parallel-initialization" class="table-of-contents__link toc-highlight">Parallel Initialization</a></li><li><a href="#multiple-drives" class="table-of-contents__link toc-highlight">Multiple Drives</a><ul><li><a href="#multiple-identities" class="table-of-contents__link toc-highlight">Multiple Identities</a></li><li><a href="#joining-filesystems" class="table-of-contents__link toc-highlight">Joining Filesystems</a></li></ul></li><li><a href="#corrupt-post-data" class="table-of-contents__link toc-highlight">Corrupt PoST Data</a></li><li><a href="#post-metadata" class="table-of-contents__link toc-highlight">PoST Metadata</a></li><li><a href="#networking" class="table-of-contents__link toc-highlight">Networking</a><ul><li><a href="#nat-traversal" class="table-of-contents__link toc-highlight">NAT Traversal</a></li><li><a href="#number-of-connections" class="table-of-contents__link toc-highlight">Number of Connections</a></li><li><a href="#private-nodes" class="table-of-contents__link toc-highlight">Private Nodes</a></li></ul></li><li><a href="#performance-fine-tuning-of-a-node" class="table-of-contents__link toc-highlight">Performance fine tuning of a node</a><ul><li><a href="#verifying-workers" class="table-of-contents__link toc-highlight">Verifying workers</a></li><li><a href="#randomx-fast-mode-1" class="table-of-contents__link toc-highlight">RandomX fast mode</a></li></ul></li><li><a href="#additional-troubleshooting" class="table-of-contents__link toc-highlight">Additional troubleshooting</a><ul><li><a href="#timesync-peers-are-not-time-synced" class="table-of-contents__link toc-highlight"><code>timesync: peers are not time synced</code></a></li><li><a href="#my-node-uses-too-much-memory-and-i-dont-know-why" class="table-of-contents__link toc-highlight">My node uses too much memory and I don&#39;t know why</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/teamspacemesh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/spacemeshos/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://spacemesh.io/resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dash.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dashboard</a></li><li class="footer__item"><a href="https://explorer.spacemesh.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Spacemesh.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0555323c.js"></script>
<script src="/assets/js/main.82529be2.js"></script>
</body>
</html>